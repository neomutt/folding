int mutt_account_match(const ACCOUNT *a1, const ACCOUNT *a2)

int mutt_account_fromurl(ACCOUNT *account, ciss_url_t *url)

void mutt_account_tourl(ACCOUNT *account, ciss_url_t *url)

int mutt_account_getuser(ACCOUNT *account)

int mutt_account_getlogin(ACCOUNT *account)

int mutt_account_getpass(ACCOUNT *account)

void mutt_account_unsetpass(ACCOUNT *account)

static const char *alias_format_str(char *dest, size_t destlen, size_t col, int cols,
                                    char op, const char *src, const char *fmt,
                                    const char *ifstring, const char *elsestring,
                                    unsigned long data, format_flag flags)

static void alias_entry(char *s, size_t slen, MUTTMENU *m, int num)

static int alias_tag(MUTTMENU *menu, int n, int m)

static int alias_sort_alias(const void *a, const void *b)

static int alias_sort_address(const void *a, const void *b)

void mutt_alias_menu(char *buf, size_t buflen, ALIAS *aliases)

static ADDRESS *expand_aliases_r(ADDRESS *a, LIST **expn)

void mutt_expand_aliases_env(ENVELOPE *env)

static void write_safe_address(FILE *fp, char *s)

static void recode_buf(char *buf, size_t buflen)

void mutt_create_alias(ENVELOPE *cur, ADDRESS *iadr)

int mutt_check_alias_name(const char *s, char *dest, size_t destlen)

void mutt_alias_add_reverse(ALIAS *t)

void mutt_alias_delete_reverse(ALIAS *t)

int mutt_alias_complete(char *s, size_t buflen)

static bool string_is_address(const char *str, const char *u, const char *d)

bool mutt_addr_is_user(ADDRESS *addr)

int ascii_strcasecmp(const char *a, const char *b)

int ascii_strncasecmp(const char *a, const char *b, int n)

int mutt_get_tmp_attachment(BODY *a)

int mutt_compose_attachment(BODY *a)

int mutt_edit_attachment(BODY *a)

void mutt_check_lookup_list(BODY *b, char *type, int len)

int mutt_view_attachment(FILE *fp, BODY *a, int flag, HEADER *hdr, ATTACHPTR **idx, short idxlen)

int mutt_pipe_attachment(FILE *fp, BODY *b, const char *path, char *outfile)

static FILE *save_attachment_open(char *path, int flags)

int mutt_save_attachment(FILE *fp, BODY *m, char *path, int flags, HEADER *hdr)

int mutt_decode_save_attachment(FILE *fp, BODY *m, char *path, int displaying, int flags)

int mutt_print_attachment(FILE *fp, BODY *a)

size_t mutt_to_base64(char *out, const char *cin, size_t len, size_t olen)

int mutt_from_base64(char *out, const char *in)

static int bcache_path(ACCOUNT *account, const char *mailbox, char *dst, size_t dstlen)

body_cache_t *mutt_bcache_open(ACCOUNT *account, const char *mailbox)

void mutt_bcache_close(body_cache_t **bcache)

int mutt_bcache_commit(body_cache_t *bcache, const char *id)

static int mutt_bcache_move(body_cache_t *bcache, const char *id, const char *newid)

int mutt_bcache_del(body_cache_t *bcache, const char *id)

int mutt_bcache_exists(body_cache_t *bcache, const char *id)

int mutt_bcache_list(body_cache_t *bcache,
                     int (*want_id)(const char *id, body_cache_t *bcache, void *data),
                     void *data)

static void destroy_state(struct browser_state *state)

static int browser_compare_subject(const void *a, const void *b)

static int browser_compare_desc(const void *a, const void *b)

static int browser_compare_date(const void *a, const void *b)

static int browser_compare_size(const void *a, const void *b)

static int browser_compare_count(const void *a, const void *b)

static int browser_compare_count_new(const void *a, const void *b)

static int browser_compare(const void *a, const void *b)

static void browser_sort(struct browser_state *state)

static int link_is_dir(const char *folder, const char *path)

static const char *folder_format_str(char *dest, size_t destlen, size_t col, int cols,
                                     char op, const char *src, const char *fmt,
                                     const char *ifstring, const char *elsestring,
                                     unsigned long data, format_flag flags)

static const char *newsgroup_format_str(char *dest, size_t destlen, size_t col, int cols,
                                        char op, const char *src, const char *fmt,
                                        const char *ifstring, const char *elsestring,
                                        unsigned long data, format_flag flags)

static void add_folder(MUTTMENU *m, struct browser_state *state, const char *name,
                       const char *desc, const struct stat *s, BUFFY *b, void *data)

static void init_state(struct browser_state *state, MUTTMENU *menu)

static int examine_directory(MUTTMENU *menu, struct browser_state *state,
                             char *d, const char *prefix)

static int examine_vfolders(MUTTMENU *menu, struct browser_state *state)

static int examine_mailboxes(MUTTMENU *menu, struct browser_state *state)

static int select_file_search(MUTTMENU *menu, regex_t *re, int n)

static int select_vfolder_search(MUTTMENU *menu, regex_t *re, int n)

static void folder_entry(char *s, size_t slen, MUTTMENU *menu, int num)

static void vfolder_entry(char *s, size_t slen, MUTTMENU *menu, int num)

static void browser_highlight_default(struct browser_state *state, MUTTMENU *menu)

static void init_menu(struct browser_state *state, MUTTMENU *menu, char *title,
                      size_t titlelen, int buffy)

static int file_tag(MUTTMENU *menu, int n, int m)

void mutt_browser_select_dir(char *f)

void _mutt_select_file(char *f, size_t flen, int flags, char ***files, int *numfiles)

void mutt_buffer_free(BUFFER **p)

int mutt_buffer_printf(BUFFER *buf, const char *fmt, ...)

static void mutt_buffer_add(BUFFER *buf, const char *s, size_t len)

void mutt_buffer_addstr(BUFFER *buf, const char *s)

void mutt_buffer_addch(BUFFER *buf, char c)

int mutt_extract_token(BUFFER *dest, BUFFER *tok, int flags)

static int fseek_last_message(FILE *f)

static int test_last_status_new(FILE *f)

static int test_new_folder(const char *path)

static BUFFY *buffy_new(const char *path)

static void buffy_free(BUFFY **mailbox)

static int buffy_maildir_check_dir(BUFFY *mailbox, const char *dir_name,
                                   int check_new, int check_stats)

static int buffy_maildir_check(BUFFY *mailbox, int check_stats)

static int buffy_mbox_check(BUFFY *mailbox, struct stat *sb, int check_stats)

static void buffy_check(BUFFY *tmp, struct stat *contex_sb, int check_stats)

static BUFFY *buffy_get(const char *path)

void mutt_buffy_cleanup(const char *buf, struct stat *st)

void mutt_update_mailbox(BUFFY *b)

int mutt_parse_mailboxes(BUFFER *path, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_parse_virtual_mailboxes(BUFFER *path, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_parse_unvirtual_mailboxes(BUFFER *path, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_buffy_check(int force)

int mutt_buffy_list(void)

void mutt_buffy_setnotified(const char *path)

int mutt_buffy_notify(void)

void mutt_buffy(char *s, size_t slen)

void mutt_buffy_vfolder(char *s, size_t slen)

void mutt_set_langinfo_charset(void)

void mutt_set_langinfo_charset(void)

void mutt_canonical_charset(char *dest, size_t dlen, const char *name)

int mutt_chscmp(const char *s, const char *chs)

char *mutt_get_default_charset(void)

iconv_t mutt_iconv_open(const char *tocode, const char *fromcode, int flags)

size_t mutt_iconv(iconv_t cd, ICONV_CONST char **inbuf, size_t *inbytesleft,
                  char **outbuf, size_t *outbytesleft,
                  ICONV_CONST char **inrepls, const char *outrepl)

int mutt_convert_string(char **ps, const char *from, const char *to, int flags)

char *fgetconvs(char *buf, size_t l, FGETCONV *_fc)

int fgetconv(FGETCONV *_fc)

void fgetconv_close(FGETCONV **_fc)

bool mutt_check_charset(const char *s, bool strict)

static COLOR_LINE *new_color_line(void)

static void free_color_line(COLOR_LINE **l, int free_colors)

void ci_start_color(void)

static char *get_color_name(char *dest, size_t destlen, int val)

int mutt_alloc_color(int fg, int bg)

void mutt_free_color(int fg, int bg)

static int parse_color_name(const char *s, int *col, int *attr, int is_fg, BUFFER *err)

static void do_uncolor(BUFFER *buf, BUFFER *s, COLOR_LINE **cl, int *do_cache, int parse_uncolor)

static int _mutt_parse_uncolor(BUFFER *buf, BUFFER *s, unsigned long data,
                               BUFFER *err, short parse_uncolor)

int mutt_parse_uncolor(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_parse_unmono(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int add_pattern(COLOR_LINE **top, const char *s, int sensitive, int fg,
                       int bg, int attr, BUFFER *err, int is_index, int match)

static int parse_object(BUFFER *buf, BUFFER *s, int *o, int *ql, BUFFER *err)

static int parse_color_pair(BUFFER *buf, BUFFER *s, int *fg, int *bg, int *attr, BUFFER *err)

static int parse_attr_spec(BUFFER *buf, BUFFER *s, int *fg, int *bg, int *attr, BUFFER *err)

static int fgbgattr_to_color(int fg, int bg, int attr)

static int _mutt_parse_color(BUFFER *buf, BUFFER *s, BUFFER *err,
                             parser_callback_t callback, short dry_run)

int mutt_parse_color(BUFFER *buff, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_parse_mono(BUFFER *buff, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_display_message(HEADER *cur)

void ci_bounce_message(HEADER *h)

static void pipe_set_flags(int decode, int print, int *cmflags, int *chflags)

static void pipe_msg(HEADER *h, FILE *fp, int decode, int print)

static int _mutt_pipe_message(HEADER *h, char *cmd, int decode, int print,
                              int split, char *sep)

void mutt_pipe_message(HEADER *h)

void mutt_print_message(HEADER *h)

int mutt_select_sort(int reverse)

void mutt_shell_escape(void)

void mutt_enter_command(void)

void mutt_display_address(ENVELOPE *env)

static void set_copy_flags(HEADER *hdr, int decode, int decrypt, int *cmflags, int *chflags)

int _mutt_save_message(HEADER *h, CONTEXT *ctx, int delete, int decode, int decrypt)

int mutt_save_message(HEADER *h, int delete, int decode, int decrypt)

void mutt_version(void)

void mutt_edit_content_type(HEADER *h, BODY *b, FILE *fp)

static int _mutt_check_traditional_pgp(HEADER *h, int *redraw)

int mutt_check_traditional_pgp(HEADER *h, int *redraw)

int mutt_complete(char *s, size_t slen)

static void snd_entry(char *b, size_t blen, MUTTMENU *menu, int num)

static void redraw_crypt_lines(HEADER *msg)

static void redraw_mix_line(LIST *chain)

static int check_attachments(ATTACHPTR **idx, short idxlen)

static void draw_envelope_addr(int line, ADDRESS *addr)

static void draw_envelope(HEADER *msg, char *fcc)

static void edit_address_list(int line, ADDRESS **addr)

static int delete_attachment(MUTTMENU *menu, short *idxlen, int x)

static void update_idx(MUTTMENU *menu, ATTACHPTR **idx, short idxlen)

static void compose_menu_redraw(MUTTMENU *menu)

static void compose_menu_redraw(MUTTMENU *menu)

static unsigned long cum_attachs_size(MUTTMENU *menu)

static const char *compose_format_str(char *buf, size_t buflen, size_t col, int cols,
                                      char op, const char *src, const char *prefix,
                                      const char *ifstring, const char *elsestring,
                                      unsigned long data, format_flag flags)

static void compose_status_line(char *buf, size_t buflen, size_t col, int cols,
                                MUTTMENU *menu, const char *p)

int mutt_compose_menu(HEADER *msg, /* structure for new message */
                      char *fcc,   /* where to save a copy of the message */
                      size_t fcclen, HEADER *cur, /* current message */
                      int flags)

static int lock_realpath(CONTEXT *ctx, int excl)

static void unlock_realpath(CONTEXT *ctx)

static int setup_paths(CONTEXT *ctx)

static int get_size(const char *path)

static void store_size(const CONTEXT *ctx)

static const char *find_hook(int type, const char *path)

static COMPRESS_INFO *set_compress_info(CONTEXT *ctx)

static void free_compress_info(CONTEXT *ctx)

static char *escape_path(char *src)

static const char *cb_format_str(char *dest, size_t destlen, size_t col, int cols,
                                 char op, const char *src, const char *fmt,
                                 const char *ifstring, const char *elsestring,
                                 unsigned long data, format_flag flags)

static void expand_command_str(const CONTEXT *ctx, const char *cmd, char *buf, int buflen)

static int execute_command(CONTEXT *ctx, const char *command, const char *progress)

static int comp_open_mailbox(CONTEXT *ctx)

static int comp_open_append_mailbox(CONTEXT *ctx, int flags)

static int comp_close_mailbox(CONTEXT *ctx)

static int comp_check_mailbox(CONTEXT *ctx, int *index_hint)

static int comp_open_message(CONTEXT *ctx, MESSAGE *msg, int msgno)

static int comp_close_message(CONTEXT *ctx, MESSAGE *msg)

static int comp_commit_message(CONTEXT *ctx, MESSAGE *msg)

static int comp_open_new_message(MESSAGE *msg, CONTEXT *ctx, HEADER *hdr)

bool mutt_comp_can_append(CONTEXT *ctx)

bool mutt_comp_can_read(const char *path)

static int comp_sync_mailbox(CONTEXT *ctx, int *index_hint)

int mutt_comp_valid_command(const char *cmd)

int mutt_copy_hdr(FILE *in, FILE *out, LOFF_T off_start, LOFF_T off_end,
                  int flags, const char *prefix)

int mutt_copy_header(FILE *in, HEADER *h, FILE *out, int flags, const char *prefix)

static int count_delete_lines(FILE *fp, BODY *b, LOFF_T *length, size_t datelen)

int _mutt_copy_message(FILE *fpout, FILE *fpin, HEADER *hdr, BODY *body, int flags, int chflags)

int mutt_copy_message(FILE *fpout, CONTEXT *src, HEADER *hdr, int flags, int chflags)

static int _mutt_append_message(CONTEXT *dest, FILE *fpin, CONTEXT *src,
                                HEADER *hdr, BODY *body, int flags, int chflags)

int mutt_append_message(CONTEXT *dest, CONTEXT *src, HEADER *hdr, int cmflags, int chflags)

static int copy_delete_attach(BODY *b, FILE *fpin, FILE *fpout, char *date)

static void format_address_header(char **h, ADDRESS *a)

static int address_header_decode(char **h)

void crypt_current_time(STATE *s, char *app_name)

void crypt_forget_passphrase(void)

static void disable_coredumps(void)

int crypt_valid_passphrase(int flags)

int mutt_protect(HEADER *msg, char *keylist)

int mutt_is_multipart_signed(BODY *b)

int mutt_is_multipart_encrypted(BODY *b)

int mutt_is_valid_multipart_pgp_encrypted(BODY *b)

int mutt_is_malformed_multipart_pgp_encrypted(BODY *b)

int mutt_is_application_pgp(BODY *m)

int mutt_is_application_smime(BODY *m)

int crypt_query(BODY *m)

int crypt_write_signed(BODY *a, STATE *s, const char *tempfile)

void convert_to_7bit(BODY *a)

void crypt_extract_keys_from_messages(HEADER *h)

int crypt_get_keys(HEADER *msg, char **keylist, int oppenc_mode)

void crypt_opportunistic_encrypt(HEADER *msg)

static void crypt_fetch_signatures(BODY ***signatures, BODY *a, int *n)

int mutt_signed_handler(BODY *a, STATE *s)

const char *crypt_get_fingerprint_or_id(char *p, const char **pphint,
                                        const char **ppl, const char **pps)

bool crypt_is_numerical_keyid(const char *s)

void crypt_init(void)

void crypt_invoke_message(int type)

void crypt_pgp_void_passphrase(void)

int crypt_pgp_valid_passphrase(void)

int crypt_pgp_decrypt_mime(FILE *a, FILE **b, BODY *c, BODY **d)

int crypt_pgp_application_pgp_handler(BODY *m, STATE *s)

int crypt_pgp_encrypted_handler(BODY *a, STATE *s)

void crypt_pgp_invoke_getkeys(ADDRESS *addr)

int crypt_pgp_check_traditional(FILE *fp, BODY *b, int tagged_only)

char *crypt_pgp_findkeys(ADDRESS *adrlist, int oppenc_mode)

void crypt_pgp_invoke_import(const char *fname)

int crypt_pgp_verify_one(BODY *sigbdy, STATE *s, const char *tempf)

int crypt_pgp_send_menu(HEADER *msg)

void crypt_pgp_extract_keys_from_attachment_list(FILE *fp, int tag, BODY *top)

void crypt_pgp_set_sender(const char *sender)

void crypt_smime_void_passphrase(void)

int crypt_smime_valid_passphrase(void)

int crypt_smime_decrypt_mime(FILE *a, FILE **b, BODY *c, BODY **d)

int crypt_smime_application_smime_handler(BODY *m, STATE *s)

void crypt_smime_encrypted_handler(BODY *a, STATE *s)

void crypt_smime_getkeys(ENVELOPE *env)

int crypt_smime_verify_sender(HEADER *h)

char *crypt_smime_findkeys(ADDRESS *adrlist, int oppenc_mode)

void crypt_smime_invoke_import(char *infile, char *mailbox)

int crypt_smime_verify_one(BODY *sigbdy, STATE *s, const char *tempf)

int crypt_smime_send_menu(HEADER *msg)

void crypt_smime_set_sender(const char *sender)

static void redraw_if_needed(gpgme_ctx_t ctx)

static int digit_or_letter(const unsigned char *s)

static void print_utf8(FILE *fp, const char *buf, size_t len)

static const char *crypt_keyid(crypt_key_t *k)

static const char *crypt_long_keyid(crypt_key_t *k)

static const char *crypt_short_keyid(crypt_key_t *k)

static const char *crypt_fpr(crypt_key_t *k)

static const char *crypt_fpr_or_lkeyid(crypt_key_t *k)

static char *crypt_key_abilities(int flags)

static char crypt_flags(int flags)

static crypt_key_t *crypt_copy_key(crypt_key_t *key)

static void crypt_free_key(crypt_key_t **keylist)

static bool crypt_key_is_valid(crypt_key_t *k)

static int crypt_id_is_strong(crypt_key_t *key)

static int crypt_id_is_valid(crypt_key_t *key)

static int crypt_id_matches_addr(ADDRESS *addr, ADDRESS *u_addr, crypt_key_t *key)

static gpgme_ctx_t create_gpgme_context(int for_smime)

static gpgme_data_t create_gpgme_data(void)

static gpgme_data_t body_to_data_object(BODY *a, int convert)

static gpgme_data_t file_to_data_object(FILE *fp, long offset, long length)

static int data_object_to_stream(gpgme_data_t data, FILE *fp)

static char *data_object_to_tempfile(gpgme_data_t data, char *tempf, FILE **ret_fp)

static void free_recipient_set(gpgme_key_t **p_rset)

static gpgme_key_t *create_recipient_set(const char *keylist, gpgme_protocol_t protocol)

static int set_signer(gpgme_ctx_t ctx, int for_smime)

static gpgme_error_t set_pka_sig_notation(gpgme_ctx_t ctx)

static char *encrypt_gpgme_object(gpgme_data_t plaintext, gpgme_key_t *rset,
                                  int use_smime, int combined_signed)

static int get_micalg(gpgme_ctx_t ctx, int use_smime, char *buf, size_t buflen)

static void print_time(time_t t, STATE *s)

static BODY *sign_message(BODY *a, int use_smime)

static int show_sig_summary(unsigned long sum, gpgme_ctx_t ctx, gpgme_key_t key,
                            int idx, STATE *s, gpgme_signature_t sig)

static void show_fingerprint(gpgme_key_t key, STATE *state)

static void show_one_sig_validity(gpgme_ctx_t ctx, int idx, STATE *s)

static void print_smime_keyinfo(const char *msg, gpgme_signature_t sig,
                                gpgme_key_t key, STATE *s)

static int show_one_sig_status(gpgme_ctx_t ctx, int idx, STATE *s)

static int verify_one(BODY *sigbdy, STATE *s, const char *tempfile, int is_smime)

int pgp_gpgme_verify_one(BODY *sigbdy, STATE *s, const char *tempfile)

int smime_gpgme_verify_one(BODY *sigbdy, STATE *s, const char *tempfile)

static BODY *decrypt_part(BODY *a, STATE *s, FILE *fpout, int is_smime, int *r_is_signed)

int pgp_gpgme_decrypt_mime(FILE *fpin, FILE **fpout, BODY *b, BODY **cur)

int smime_gpgme_decrypt_mime(FILE *fpin, FILE **fpout, BODY *b, BODY **cur)

static int pgp_gpgme_extract_keys(gpgme_data_t keydata, FILE **fp, int dryrun)

static int line_compare(const char *a, size_t n, const char *b)

static int pgp_check_traditional_one_body(FILE *fp, BODY *b, int tagged_only)

int pgp_gpgme_check_traditional(FILE *fp, BODY *b, int tagged_only)

void pgp_gpgme_invoke_import(const char *fname)

static void copy_clearsigned(gpgme_data_t data, STATE *s, char *charset)

int pgp_gpgme_application_handler(BODY *m, STATE *s)

int pgp_gpgme_encrypted_handler(BODY *a, STATE *s)

int smime_gpgme_application_handler(BODY *a, STATE *s)

static const char *crypt_entry_fmt(char *dest, size_t destlen, size_t col, int cols,
                                   char op, const char *src, const char *prefix,
                                   const char *ifstring, const char *elsestring,
                                   unsigned long data, format_flag flags)

static void crypt_entry(char *s, size_t l, MUTTMENU *menu, int num)

static int _crypt_compare_address(const void *a, const void *b)

static int crypt_compare_address(const void *a, const void *b)

static int _crypt_compare_keyid(const void *a, const void *b)

static int crypt_compare_keyid(const void *a, const void *b)

static int _crypt_compare_date(const void *a, const void *b)

static int crypt_compare_date(const void *a, const void *b)

static int _crypt_compare_trust(const void *a, const void *b)

static int crypt_compare_trust(const void *a, const void *b)

static int print_dn_part(FILE *fp, struct dn_array_s *dn, const char *key)

static void print_dn_parts(FILE *fp, struct dn_array_s *dn)

static const char *parse_dn_part(struct dn_array_s *array, const char *string)

static struct dn_array_s *parse_dn(const char *string)

static void parse_and_print_user_id(FILE *fp, const char *userid)

static unsigned int key_check_cap(gpgme_key_t key, key_cap_t cap)

static void print_key_info(gpgme_key_t key, FILE *fp)

static void verify_key(crypt_key_t *key)

static char *list_to_pattern(LIST *list)

static crypt_key_t *get_candidates(LIST *hints, unsigned int app, int secret)

static LIST *crypt_add_string_to_hints(LIST *hints, const char *str)

static crypt_key_t *crypt_select_key(crypt_key_t *keys, ADDRESS *p, const char *s,
                                     unsigned int app, int *forced_valid)

static crypt_key_t *crypt_getkeybyaddr(ADDRESS *a, short abilities, unsigned int app,
                                       int *forced_valid, int oppenc_mode)

static crypt_key_t *crypt_getkeybystr(char *p, short abilities, unsigned int app, int *forced_valid)

static crypt_key_t *crypt_ask_for_key(char *tag, char *whatfor, short abilities,
                                      unsigned int app, int *forced_valid)

static char *find_keys(ADDRESS *adrlist, unsigned int app, int oppenc_mode)

char *pgp_gpgme_findkeys(ADDRESS *adrlist, int oppenc_mode)

char *smime_gpgme_findkeys(ADDRESS *adrlist, int oppenc_mode)

static void init_common(void)

static void init_pgp(void)

static void init_smime(void)

void pgp_gpgme_init(void)

void smime_gpgme_init(void)

static int gpgme_send_menu(HEADER *msg, int is_smime)

int pgp_gpgme_send_menu(HEADER *msg)

int smime_gpgme_send_menu(HEADER *msg)

static int verify_sender(HEADER *h, gpgme_protocol_t protocol)

int smime_gpgme_verify_sender(HEADER *h)

void mutt_gpgme_set_sender(const char *sender)

void crypto_module_register(crypt_module_specs_t specs)

crypt_module_specs_t crypto_module_lookup(int identifier)

static void crypt_mod_pgp_void_passphrase(void)

static int crypt_mod_pgp_valid_passphrase(void)

static int crypt_mod_pgp_decrypt_mime(FILE *a, FILE **b, BODY *c, BODY **d)

static int crypt_mod_pgp_application_handler(BODY *m, STATE *s)

static char *crypt_mod_pgp_findkeys(ADDRESS *adrlist, int oppenc_mode)

static BODY *crypt_mod_pgp_sign_message(BODY *a)

static int crypt_mod_pgp_verify_one(BODY *sigbdy, STATE *s, const char *tempf)

static int crypt_mod_pgp_send_menu(HEADER *msg)

static BODY *crypt_mod_pgp_encrypt_message(BODY *a, char *keylist, int sign)

static BODY *crypt_mod_pgp_make_key_attachment(char *tempf)

static int crypt_mod_pgp_check_traditional(FILE *fp, BODY *b, int tagged_only)

static BODY *crypt_mod_pgp_traditional_encryptsign(BODY *a, int flags, char *keylist)

static int crypt_mod_pgp_encrypted_handler(BODY *m, STATE *s)

static void crypt_mod_pgp_invoke_getkeys(ADDRESS *addr)

static void crypt_mod_pgp_invoke_import(const char *fname)

static void crypt_mod_pgp_extract_keys_from_attachment_list(FILE *fp, int tag, BODY *top)

static void crypt_mod_pgp_init(void)

static void crypt_mod_pgp_void_passphrase(void)

static int crypt_mod_pgp_valid_passphrase(void)

static int crypt_mod_pgp_decrypt_mime(FILE *a, FILE **b, BODY *c, BODY **d)

static int crypt_mod_pgp_application_handler(BODY *m, STATE *s)

static int crypt_mod_pgp_encrypted_handler(BODY *m, STATE *s)

static int crypt_mod_pgp_check_traditional(FILE *fp, BODY *b, int tagged_only)

static void crypt_mod_pgp_invoke_import(const char *fname)

static char *crypt_mod_pgp_findkeys(ADDRESS *adrlist, int oppenc_mode)

static BODY *crypt_mod_pgp_sign_message(BODY *a)

static int crypt_mod_pgp_verify_one(BODY *sigbdy, STATE *s, const char *tempf)

static int crypt_mod_pgp_send_menu(HEADER *msg)

static BODY *crypt_mod_pgp_encrypt_message(BODY *a, char *keylist, int sign)

static BODY *crypt_mod_pgp_make_key_attachment(char *tempf)

static void crypt_mod_pgp_set_sender(const char *sender)

static void crypt_mod_smime_void_passphrase(void)

static int crypt_mod_smime_valid_passphrase(void)

static int crypt_mod_smime_decrypt_mime(FILE *a, FILE **b, BODY *c, BODY **d)

static int crypt_mod_smime_application_handler(BODY *m, STATE *s)

static char *crypt_mod_smime_findkeys(ADDRESS *adrlist, int oppenc_mode)

static BODY *crypt_mod_smime_sign_message(BODY *a)

static int crypt_mod_smime_verify_one(BODY *sigbdy, STATE *s, const char *tempf)

static int crypt_mod_smime_send_menu(HEADER *msg)

static void crypt_mod_smime_getkeys(ENVELOPE *env)

static int crypt_mod_smime_verify_sender(HEADER *h)

static BODY *crypt_mod_smime_build_smime_entity(BODY *a, char *certlist)

static void crypt_mod_smime_invoke_import(char *infile, char *mailbox)

static void crypt_mod_smime_init(void)

static void crypt_mod_smime_void_passphrase(void)

static int crypt_mod_smime_valid_passphrase(void)

static int crypt_mod_smime_decrypt_mime(FILE *a, FILE **b, BODY *c, BODY **d)

static int crypt_mod_smime_application_handler(BODY *m, STATE *s)

static char *crypt_mod_smime_findkeys(ADDRESS *adrlist, int oppenc_mode)

static BODY *crypt_mod_smime_sign_message(BODY *a)

static int crypt_mod_smime_verify_one(BODY *sigbdy, STATE *s, const char *tempf)

static int crypt_mod_smime_send_menu(HEADER *msg)

static BODY *crypt_mod_smime_build_smime_entity(BODY *a, char *certlist)

static int crypt_mod_smime_verify_sender(HEADER *h)

void mutt_refresh(void)

void mutt_need_hard_redraw(void)

event_t mutt_getch(void)

int _mutt_get_field(const char *field, char *buf, size_t buflen, int complete,
                    int multiple, char ***files, int *numfiles)

int mutt_get_field_unbuffered(char *msg, char *buf, size_t buflen, int flags)

void mutt_clear_error(void)

void mutt_edit_file(const char *editor, const char *data)

int mutt_yesorno(const char *msg, int def)

void mutt_query_exit(void)

static void curses_message(int error, const char *fmt, va_list ap)

void mutt_curses_error(const char *fmt, ...)

void mutt_curses_message(const char *fmt, ...)

void mutt_progress_init(progress_t *progress, const char *msg,
                        unsigned short flags, unsigned short inc, long size)

static void message_bar(int percent, const char *fmt, ...)

void mutt_progress_update(progress_t *progress, long pos, int percent)

void mutt_init_windows(void)

void mutt_free_windows(void)

void mutt_reflow_windows(void)

static void reflow_message_window_rows(int mw_rows)

int mutt_window_move(mutt_window_t *win, int row, int col)

int mutt_window_mvaddch(mutt_window_t *win, int row, int col, const chtype ch)

int mutt_window_mvaddstr(mutt_window_t *win, int row, int col, const char *str)

static int vw_printw(SLcurses_Window_Type *win, const char *fmt, va_list ap)

int mutt_window_mvprintw(mutt_window_t *win, int row, int col, const char *fmt, ...)

void mutt_window_clrtoeol(mutt_window_t *win)

void mutt_window_clearline(mutt_window_t *win, int row)

void mutt_window_getyx(mutt_window_t *win, int *y, int *x)

void mutt_show_error(void)

void mutt_endwin(const char *msg)

void mutt_perror(const char *s)

int mutt_any_key_to_continue(const char *s)

int mutt_do_pager(const char *banner, const char *tempfile, int do_color, pager_t *info)

int _mutt_enter_fname(const char *prompt, char *buf, size_t blen, int buffy,
                      int multiple, char ***files, int *numfiles, int flags)

void mutt_unget_event(int ch, int op)

void mutt_unget_string(char *s)

void mutt_push_macro_event(int ch, int op)

void mutt_flush_macro_to_endcond(void)

void mutt_flushinp(void)

void mutt_curs_set(int cursor)

int mutt_multi_choice(char *prompt, char *letters)

int mutt_addwch(wchar_t wc)

void mutt_format_string(char *dest, size_t destlen, int min_width, int max_width,
                        int justify, char m_pad_char, const char *s, size_t n, int arboreal)

static void format_s_x(char *dest, size_t destlen, const char *prefix,
                       const char *s, int arboreal)

void mutt_format_s(char *dest, size_t destlen, const char *prefix, const char *s)

void mutt_format_s_tree(char *dest, size_t destlen, const char *prefix, const char *s)

void mutt_paddstr(int n, const char *s)

size_t mutt_wstr_trunc(const char *src, size_t maxlen, size_t maxwid, size_t *width)

int mutt_charlen(const char *s, int *width)

int mutt_strwidth(const char *s)

static void collapse_all(MUTTMENU *menu, int toggle)

static int ci_next_undeleted(int msgno)

static int ci_previous_undeleted(int msgno)

static int ci_first_message(void)

static int mx_toggle_write(CONTEXT *ctx)

static void resort_index(MUTTMENU *menu)

void update_index(MUTTMENU *menu, CONTEXT *ctx, int check, int oldcount, int index_hint)

static int main_change_folder(MUTTMENU *menu, int op, char *buf, size_t bufsz,
                              int *oldcount, int *index_hint, int flags)

bool mutt_ts_capability(void)

void mutt_ts_status(char *str)

void mutt_ts_icon(char *str)

void index_make_entry(char *s, size_t l, MUTTMENU *menu, int num)

int index_color(int index_no)

void mutt_draw_statusline(int cols, const char *buf, int buflen)

static void index_menu_redraw(MUTTMENU *menu)

int mutt_index_menu(void)

void mutt_set_header_color(CONTEXT *ctx, HEADER *curhdr)

static time_t compute_tz(time_t g, struct tm *utc)

time_t mutt_local_tz(time_t t)

time_t mutt_mktime(struct tm *t, int local)

static int is_leap_year_feb(struct tm *tm)

void mutt_normalize_time(struct tm *tm)

static char *skip_ws(char *s)

static char *get_token(char *d, size_t l, char *s)

static int sgml_fputc(int c, FILE *out)

static int sgml_fputs(const char *s, FILE *out)

static int print_it(int special, char *str, FILE *out, int docstat)

static int flush_doc(int docstat, FILE *out)

static int commit_buff(char *buff, char **d, FILE *out, int docstat)

static int sgml_id_fputs(const char *s, FILE *out)

void print_ref(FILE *out, int output_dollar, const char *ref)

static int handle_docline(char *l, FILE *out, int docstat)

static int buff2type(const char *s)

static void pretty_default(char *t, size_t l, const char *s, int type)

static void char_to_escape(char *dest, unsigned int c)

static void conf_char_to_escape(unsigned int c, FILE *out)

static void conf_print_strval(const char *v, FILE *out)

static const char *type2human(int type)

static void man_print_strval(const char *v, FILE *out)

static void sgml_print_strval(const char *v, FILE *out)

static void print_confline(const char *varname, int type, const char *val, FILE *out)

static void handle_confline(char *s, FILE *out)

static void makedoc(FILE *in, FILE *out)

int main(int argc, char *argv[])

static int dotlock_init_privs(void)

static void BEGIN_PRIVILEGED(void)

static void END_PRIVILEGED(void)

static void usage(const char *av0)

static int dotlock_check_stats(struct stat *fsb, struct stat *lsb)

static void dotlock_expand_link(char *newpath, const char *path, const char *link)

static int dotlock_try(void)

static int dotlock_deference_symlink(char *d, size_t l, const char *path)

static int dotlock_prepare(char *bn, size_t l, const char *f, int _fd)

static int dotlock_lock(const char *realpath)

static int dotlock_unlock(const char *realpath)

static int dotlock_unlink(const char *realpath)

static int dotlock_dispatch(const char *f, int fd)

int dotlock_invoke(const char *path, int fd, int flags, int retry)

int main(int argc, char **argv)

static char **be_snarf_data(FILE *f, char **buf, int *bufmax, int *buflen,
                            LOFF_T offset, int bytes, int prefix)

static char **be_snarf_file(const char *path, char **buf, int *max, int *len, int verbose)

static int be_barf_file(const char *path, char **buf, int buflen)

static void be_free_memory(char **buf, int buflen)

static char **be_include_messages(char *msg, char **buf, int *bufmax,
                                  int *buflen, int pfx, int inc_hdrs)

static void be_print_header(ENVELOPE *env)

static void be_edit_header(ENVELOPE *e, int force)

int mutt_builtin_editor(const char *path, HEADER *msg, HEADER *cur)

static int edit_one_message(CONTEXT *ctx, HEADER *cur)

int mutt_edit_message(CONTEXT *ctx, HEADER *hdr)

static int my_wcwidth(wchar_t wc)

static int my_wcswidth(const wchar_t *s, size_t n)

static int my_addwch(wchar_t wc)

static size_t width_ceiling(const wchar_t *s, size_t n, int w1)

static void my_wcstombs(char *dest, size_t dlen, const wchar_t *src, size_t slen)

static size_t my_mbstowcs(wchar_t **pwbuf, size_t *pwbuflen, size_t i, char *buf)

static void replace_part(ENTER_STATE *state, size_t from, char *buf)

static inline int is_shell_char(wchar_t ch)

int mutt_enter_string(char *buf, size_t buflen, int col, int flags)

int _mutt_enter_string(char *buf, size_t buflen, int col, int flags, int multiple,
                       char ***files, int *numfiles, ENTER_STATE *state)

void mutt_free_enter_state(ENTER_STATE **esp)

void mutt_exit(int code)

pid_t mutt_create_filter_fd(const char *cmd, FILE **in, FILE **out, FILE **err,
                            int fdin, int fdout, int fderr)

pid_t mutt_create_filter(const char *s, FILE **in, FILE **out, FILE **err)

int mutt_wait_filter(pid_t pid)

void _mutt_set_flag(CONTEXT *ctx, HEADER *h, int flag, int bf, int upd_ctx)

void mutt_tag_set_flag(int flag, int bf)

int mutt_thread_set_flag(HEADER *hdr, int flag, int bf, int subthread)

int mutt_change_flag(HEADER *h, int bf)

static const char *next_word(const char *s)

int mutt_check_month(const char *s)

static bool is_day_name(const char *s)

int is_from(const char *s, char *path, size_t pathlen, time_t *tp)

int getdnsdomainname(char *d, size_t len)

static void fix_uid(char *uid)

static pgp_key_t parse_pub_line(char *buf, int *is_subkey, pgp_key_t k)

pgp_key_t pgp_get_candidates(pgp_ring_t keyring, LIST *hints)

group_t *mutt_pattern_group(const char *k)

static void group_remove(group_t *g)

int mutt_group_context_clear(group_context_t **ctx)

static int empty_group(group_t *g)

void mutt_group_context_add(group_context_t **ctx, group_t *group)

void mutt_group_context_destroy(group_context_t **ctx)

static void group_add_adrlist(group_t *g, ADDRESS *a)

static int group_remove_adrlist(group_t *g, ADDRESS *a)

static int group_add_rx(group_t *g, const char *s, int flags, BUFFER *err)

static int group_remove_rx(group_t *g, const char *s)

void mutt_group_context_add_adrlist(group_context_t *ctx, ADDRESS *a)

int mutt_group_context_remove_adrlist(group_context_t *ctx, ADDRESS *a)

int mutt_group_context_add_rx(group_context_t *ctx, const char *s, int flags, BUFFER *err)

int mutt_group_context_remove_rx(group_context_t *ctx, const char *s)

bool mutt_group_match(group_t *g, const char *s)

static void print_part_line(STATE *s, BODY *b, int n)

static void state_prefix_put(const char *d, size_t dlen, STATE *s)

static void convert_to_state(iconv_t cd, char *bufi, size_t *l, STATE *s)

static void decode_xbit(STATE *s, long len, int istext, iconv_t cd)

static int qp_decode_triple(char *s, char *d)

static void qp_decode_line(char *dest, char *src, size_t *l, int last)

static void decode_quoted(STATE *s, long len, int istext, iconv_t cd)

void mutt_decode_base64(STATE *s, long len, int istext, iconv_t cd)

static unsigned char decode_byte(char ch)

static void decode_uuencoded(STATE *s, long len, int istext, iconv_t cd)

static void enriched_wrap(struct enriched_state *stte)

static void enriched_flush(struct enriched_state *stte, int wrap)

static void enriched_putwc(wchar_t c, struct enriched_state *stte)

static void enriched_puts(const char *s, struct enriched_state *stte)

static void enriched_set_flags(const wchar_t *tag, struct enriched_state *stte)

static int text_enriched_handler(BODY *a, STATE *s)

static int is_mmnoask(const char *buf)

static int is_autoview(BODY *b)

static int alternative_handler(BODY *a, STATE *s)

static int message_handler(BODY *a, STATE *s)

int mutt_can_decode(BODY *a)

static int multipart_handler(BODY *a, STATE *s)

static int autoview_handler(BODY *a, STATE *s)

static int external_body_handler(BODY *b, STATE *s)

void mutt_decode_attachment(BODY *b, STATE *s)

static int text_plain_handler(BODY *b, STATE *s)

static int run_decode_and_handler(BODY *b, STATE *s, handler_t handler, int plaintext)

static int valid_pgp_encrypted_handler(BODY *b, STATE *s)

static int malformed_pgp_encrypted_handler(BODY *b, STATE *s)

int mutt_body_handler(BODY *b, STATE *s)

static unsigned int gen_string_hash(union hash_key key, unsigned int n)

static int cmp_string_key(union hash_key a, union hash_key b)

static unsigned int gen_case_string_hash(union hash_key key, unsigned int n)

static int cmp_case_string_key(union hash_key a, union hash_key b)

static unsigned int gen_int_hash(union hash_key key, unsigned int n)

static int cmp_int_key(union hash_key a, union hash_key b)

static HASH *new_hash(int nelem)

static int union_hash_insert(HASH *table, union hash_key key, void *data)

int hash_insert(HASH *table, const char *strkey, void *data)

int int_hash_insert(HASH *table, unsigned int intkey, void *data)

static struct hash_elem *union_hash_find_elem(const HASH *table, union hash_key key)

static void *union_hash_find(const HASH *table, union hash_key key)

void *hash_find(const HASH *table, const char *strkey)

struct hash_elem *hash_find_elem(const HASH *table, const char *strkey)

void *int_hash_find(const HASH *table, unsigned int intkey)

struct hash_elem *hash_find_bucket(const HASH *table, const char *strkey)

static void union_hash_delete(HASH *table, union hash_key key, const void *data,
                              void (*destroy)(void *))

void hash_delete(HASH *table, const char *strkey, const void *data, void (*destroy)(void *))

void int_hash_delete(HASH *table, unsigned int intkey, const void *data,
                     void (*destroy)(void *))

void hash_destroy(HASH **ptr, void (*destroy)(void *))

struct hash_elem *hash_walk(const HASH *table, struct hash_walk_state *state)

static void dbt_init(DBT *dbt, void *data, size_t len)

static void dbt_empty_init(DBT *dbt)

static void *hcache_bdb_open(const char *path)

static void *hcache_bdb_fetch(void *vctx, const char *key, size_t keylen)

static void hcache_bdb_free(void *vctx, void **data)

static int hcache_bdb_store(void *vctx, const char *key, size_t keylen, void *data, size_t dlen)

static int hcache_bdb_delete(void *vctx, const char *key, size_t keylen)

static void hcache_bdb_close(void **vctx)

static const char *hcache_bdb_backend(void)

static const hcache_ops_t *hcache_get_backend_ops(const char *backend)

static void *lazy_malloc(size_t siz)

static void lazy_realloc(void *ptr, size_t siz)

static unsigned char *dump_int(unsigned int i, unsigned char *d, int *off)

static void restore_int(unsigned int *i, const unsigned char *d, int *off)

static inline bool is_ascii(const char *p, size_t len)

static unsigned char *dump_char_size(char *c, unsigned char *d, int *off,
                                     ssize_t size, int convert)

static unsigned char *dump_char(char *c, unsigned char *d, int *off, int convert)

static void restore_char(char **c, const unsigned char *d, int *off, int convert)

static unsigned char *dump_address(ADDRESS *a, unsigned char *d, int *off, int convert)

static void restore_address(ADDRESS **a, const unsigned char *d, int *off, int convert)

static unsigned char *dump_list(LIST *l, unsigned char *d, int *off, int convert)

static void restore_list(LIST **l, const unsigned char *d, int *off, int convert)

static unsigned char *dump_buffer(BUFFER *b, unsigned char *d, int *off, int convert)

static void restore_buffer(BUFFER **b, const unsigned char *d, int *off, int convert)

static unsigned char *dump_parameter(PARAMETER *p, unsigned char *d, int *off, int convert)

static void restore_parameter(PARAMETER **p, const unsigned char *d, int *off, int convert)

static unsigned char *dump_body(BODY *c, unsigned char *d, int *off, int convert)

static void restore_body(BODY *c, const unsigned char *d, int *off, int convert)

static unsigned char *dump_envelope(ENVELOPE *e, unsigned char *d, int *off, int convert)

static void restore_envelope(ENVELOPE *e, const unsigned char *d, int *off, int convert)

static int crc_matches(const char *d, unsigned int crc)

static bool create_hcache_dir(const char *path)

static const char *hcache_per_folder(const char *path, const char *folder, hcache_namer_t namer)

static void *hcache_dump(header_cache_t *h, HEADER *header, int *off, unsigned int uidvalidity)

static char *get_foldername(const char *folder)

header_cache_t *mutt_hcache_open(const char *path, const char *folder, hcache_namer_t namer)

void mutt_hcache_close(header_cache_t *h)

void *mutt_hcache_fetch(header_cache_t *h, const char *key, size_t keylen)

void *mutt_hcache_fetch_raw(header_cache_t *h, const char *key, size_t keylen)

void mutt_hcache_free(header_cache_t *h, void **data)

int mutt_hcache_store(header_cache_t *h, const char *key, size_t keylen,
                      HEADER *header, unsigned int uidvalidity)

int mutt_hcache_store_raw(header_cache_t *h, const char *key, size_t keylen,
                          void *data, size_t dlen)

int mutt_hcache_delete(header_cache_t *h, const char *key, size_t keylen)

const char *mutt_hcache_backend_list(void)

int mutt_hcache_is_valid_backend(const char *s)

static void *hcache_gdbm_open(const char *path)

static void *hcache_gdbm_fetch(void *ctx, const char *key, size_t keylen)

static void hcache_gdbm_free(void *vctx, void **data)

static int hcache_gdbm_store(void *ctx, const char *key, size_t keylen, void *data, size_t dlen)

static int hcache_gdbm_delete(void *ctx, const char *key, size_t keylen)

static void hcache_gdbm_close(void **ctx)

static const char *hcache_gdbm_backend(void)

static void *hcache_kyotocabinet_open(const char *path)

static void *hcache_kyotocabinet_fetch(void *ctx, const char *key, size_t keylen)

static void hcache_kyotocabinet_free(void *vctx, void **data)

static int hcache_kyotocabinet_store(void *ctx, const char *key, size_t keylen,
                                     void *data, size_t dlen)

static int hcache_kyotocabinet_delete(void *ctx, const char *key, size_t keylen)

static void hcache_kyotocabinet_close(void **ctx)

static const char *hcache_kyotocabinet_backend(void)

static int mdb_get_r_txn(hcache_lmdb_ctx_t *ctx)

static int mdb_get_w_txn(hcache_lmdb_ctx_t *ctx)

static void *hcache_lmdb_open(const char *path)

static void *hcache_lmdb_fetch(void *vctx, const char *key, size_t keylen)

static void hcache_lmdb_free(void *vctx, void **data)

static int hcache_lmdb_store(void *vctx, const char *key, size_t keylen, void *data, size_t dlen)

static int hcache_lmdb_delete(void *vctx, const char *key, size_t keylen)

static void hcache_lmdb_close(void **vctx)

static const char *hcache_lmdb_backend(void)

static void *hcache_qdbm_open(const char *path)

static void *hcache_qdbm_fetch(void *ctx, const char *key, size_t keylen)

static void hcache_qdbm_free(void *ctx, void **data)

static int hcache_qdbm_store(void *ctx, const char *key, size_t keylen, void *data, size_t dlen)

static int hcache_qdbm_delete(void *ctx, const char *key, size_t keylen)

static void hcache_qdbm_close(void **ctx)

static const char *hcache_qdbm_backend(void)

static void *hcache_tokyocabinet_open(const char *path)

static void *hcache_tokyocabinet_fetch(void *ctx, const char *key, size_t keylen)

static void hcache_tokyocabinet_free(void *ctx, void **data)

static int hcache_tokyocabinet_store(void *ctx, const char *key, size_t keylen,
                                     void *data, size_t dlen)

static int hcache_tokyocabinet_delete(void *ctx, const char *key, size_t keylen)

static void hcache_tokyocabinet_close(void **ctx)

static const char *hcache_tokyocabinet_backend(void)

bool mutt_is_mail_list(ADDRESS *addr)

bool mutt_is_subscribed_list(ADDRESS *addr)

static bool check_for_mailing_list(ADDRESS *adr, const char *pfx, char *buf, int buflen)

static bool check_for_mailing_list_addr(ADDRESS *adr, char *buf, int buflen)

static bool first_mailing_list(char *buf, size_t buflen, ADDRESS *a)

static size_t add_index_color(char *buf, size_t buflen, format_flag flags, char color)

static const char *make_from_prefix(enum FieldType disp)

static void make_from(ENVELOPE *env, char *buf, size_t len, int do_lists)

static void make_from_addr(ENVELOPE *hdr, char *buf, size_t len, int do_lists)

static bool user_in_addr(ADDRESS *a)

static int user_is_recipient(HEADER *h)

static bool get_initials(const char *name, char *buf, int buflen)

static char *get_nth_wchar(mbchar_table *table, int index)

static char *apply_subject_mods(ENVELOPE *env)

static const char *hdr_format_str(char *dest, size_t destlen, size_t col, int cols,
                                  char op, const char *src, const char *prefix,
                                  const char *ifstring, const char *elsestring,
                                  unsigned long data, format_flag flags)

void _mutt_make_string(char *dest, size_t destlen, const char *s, CONTEXT *ctx,
                       HEADER *hdr, format_flag flags)

void mutt_make_string_info(char *dst, size_t dstlen, int cols, const char *s,
                           struct hdr_format_info *hfi, format_flag flags)

void mutt_edit_headers(const char *editor, const char *body, HEADER *msg, char *fcc, size_t fcclen)

static void label_ref_dec(CONTEXT *ctx, char *label)

static void label_ref_inc(CONTEXT *ctx, char *label)

static int label_message(CONTEXT *ctx, HEADER *hdr, char *new)

int mutt_label_message(HEADER *hdr)

void mutt_make_label_hash(CONTEXT *ctx)

void mutt_label_hash_add(CONTEXT *ctx, HEADER *hdr)

void mutt_label_hash_remove(CONTEXT *ctx, HEADER *hdr)

static const struct binding_t *help_lookup_function(int op, int menu)

void mutt_make_help(char *d, size_t dlen, const char *txt, int menu, int op)

char *mutt_compile_help(char *buf, size_t buflen, int menu, const struct mapping_t *items)

static int print_macro(FILE *f, int maxwidth, const char **macro)

static int get_wrapped_width(const char *t, size_t wid)

static int pad(FILE *f, int col, int i)

static void format_line(FILE *f, int ismacro, const char *t1, const char *t2, const char *t3)

static void dump_menu(FILE *f, int menu)

static bool is_bound(struct keymap_t *map, int op)

static void dump_unbound(FILE *f, const struct binding_t *funcs,
                         struct keymap_t *map, struct keymap_t *aux)

void mutt_help(int menu)

static void init_history(struct history *h)

void mutt_read_histfile(void)

static void shrink_histfile(void)

static void save_history(history_class_t hclass, const char *s)

void mutt_init_history(void)

void mutt_history_add(history_class_t hclass, const char *s, int save)

char *mutt_history_next(history_class_t hclass)

char *mutt_history_prev(history_class_t hclass)

void mutt_reset_history_state(history_class_t hclass)

int mutt_history_at_scratch(history_class_t hclass)

void mutt_history_save_scratch(history_class_t hclass, const char *s)

int mutt_parse_hook(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static void delete_hook(HOOK *h)

static void delete_hooks(int type)

int mutt_parse_unhook(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

void mutt_folder_hook(char *path)

char *mutt_find_hook(int type, const char *pat)

void mutt_message_hook(CONTEXT *ctx, HEADER *hdr, int type)

static int addr_hook(char *path, size_t pathlen, int type, CONTEXT *ctx, HEADER *hdr)

void mutt_default_save(char *path, size_t pathlen, HEADER *hdr)

void mutt_select_fcc(char *path, size_t pathlen, HEADER *hdr)

static char *_mutt_string_hook(const char *match, int hook)

static LIST *_mutt_list_hook(const char *match, int hook)

char *mutt_charset_hook(const char *chs)

char *mutt_iconv_hook(const char *chs)

void mutt_account_hook(const char *url)

void mutt_timeout_hook(void)

void mutt_startup_shutdown_hook(int type)

imap_auth_res_t imap_auth_anon(IMAP_DATA *idata, const char *method)

int imap_authenticate(IMAP_DATA *idata)

imap_auth_res_t imap_auth_cram_md5(IMAP_DATA *idata, const char *method)

static void hmac_md5(const char *password, char *challenge, unsigned char *response)

static void print_gss_error(OM_uint32 err_maj, OM_uint32 err_min)

imap_auth_res_t imap_auth_gss(IMAP_DATA *idata, const char *method)

imap_auth_res_t imap_auth_login(IMAP_DATA *idata, const char *method)

imap_auth_res_t imap_auth_plain(IMAP_DATA *idata, const char *method)

imap_auth_res_t imap_auth_sasl(IMAP_DATA *idata, const char *method)

static void imap_add_folder(char delim, char *folder, int noselect, int noinferiors,
                            struct browser_state *state, short isparent)

static int browse_add_list_result(IMAP_DATA *idata, const char *cmd,
                                  struct browser_state *state, short isparent)

int imap_browse(char *path, struct browser_state *state)

int imap_mailbox_create(const char *folder)

int imap_mailbox_rename(const char *mailbox)

static bool cmd_queue_full(IMAP_DATA *idata)

static IMAP_COMMAND *cmd_new(IMAP_DATA *idata)

static int cmd_queue(IMAP_DATA *idata, const char *cmdstr)

static void cmd_handle_fatal(IMAP_DATA *idata)

static int cmd_start(IMAP_DATA *idata, const char *cmdstr, int flags)

static int cmd_status(const char *s)

static void cmd_parse_expunge(IMAP_DATA *idata, const char *s)

static void cmd_parse_fetch(IMAP_DATA *idata, char *s)

static void cmd_parse_capability(IMAP_DATA *idata, char *s)

static void cmd_parse_list(IMAP_DATA *idata, char *s)

static void cmd_parse_lsub(IMAP_DATA *idata, char *s)

static void cmd_parse_myrights(IMAP_DATA *idata, const char *s)

static void cmd_parse_search(IMAP_DATA *idata, const char *s)

static void cmd_parse_status(IMAP_DATA *idata, char *s)

static void cmd_parse_enabled(IMAP_DATA *idata, const char *s)

static int cmd_handle_untagged(IMAP_DATA *idata)

int imap_cmd_start(IMAP_DATA *idata, const char *cmdstr)

int imap_cmd_step(IMAP_DATA *idata)

int imap_code(const char *s)

const char *imap_cmd_trailer(IMAP_DATA *idata)

int imap_exec(IMAP_DATA *idata, const char *cmdstr, int flags)

void imap_cmd_finish(IMAP_DATA *idata)

int imap_cmd_idle(IMAP_DATA *idata)

int imap_access(const char *path, int flags)

int imap_access(const char *path, int flags)

int imap_create_mailbox(IMAP_DATA *idata, char *mailbox)

int imap_rename_mailbox(IMAP_DATA *idata, IMAP_MBOX *mx, const char *newname)

int imap_delete_mailbox(CONTEXT *ctx, IMAP_MBOX *mx)

void imap_logout_all(void)

int imap_read_literal(FILE *fp, IMAP_DATA *idata, long bytes, progress_t *pbar)

void imap_expunge_mailbox(IMAP_DATA *idata)

static int imap_check_capabilities(IMAP_DATA *idata)

int imap_open_connection(IMAP_DATA *idata)

void imap_close_connection(IMAP_DATA *idata)

static char *imap_get_flags(LIST **hflags, char *s)

static int imap_open_mailbox(CONTEXT *ctx)

static int imap_open_mailbox_append(CONTEXT *ctx, int flags)

void imap_logout(IMAP_DATA **idata)

static int imap_open_new_message(MESSAGE *msg, CONTEXT *dest, HEADER *hdr)

static void imap_set_flag(IMAP_DATA *idata, int aclbit, int flag,
                          const char *str, char *flags, size_t flsize)

bool imap_has_flag(LIST *flag_list, const char *flag)

static int imap_make_msg_set(IMAP_DATA *idata, BUFFER *buf, int flag,
                             int changed, int invert, int *pos)

int imap_exec_msgset(IMAP_DATA *idata, const char *pre, const char *post,
                     int flag, int changed, int invert)

static bool compare_flags(HEADER *h)

int imap_sync_message(IMAP_DATA *idata, HEADER *hdr, BUFFER *cmd, int *err_continue)

static int sync_helper(IMAP_DATA *idata, int right, int flag, const char *name)

int imap_sync_mailbox(CONTEXT *ctx, int expunge)

int imap_close_mailbox(CONTEXT *ctx)

int imap_check_mailbox(CONTEXT *ctx, int force)

int imap_check(IMAP_DATA *idata, int force)

static int imap_check_mailbox_reopen(CONTEXT *ctx, int *index_hint)

static int imap_get_mailbox(const char *path, IMAP_DATA **hidata, char *buf, size_t blen)

int imap_buffy_check(int force, int check_stats)

int imap_status(char *path, int queue)

void imap_mboxcache_free(IMAP_DATA *idata)

static int do_search(const pattern_t *search, int allpats)

static int imap_compile_search(const pattern_t *pat, BUFFER *buf)

int imap_search(CONTEXT *ctx, const pattern_t *pat)

int imap_subscribe(char *path, int subscribe)

static int longest_common_prefix(char *dest, const char *src, int start, size_t dlen)

static int imap_complete_hosts(char *dest, size_t len)

int imap_complete(char *dest, size_t dlen, char *path)

int imap_fast_trash(CONTEXT *ctx, char *dest)

static void imap_update_context(IMAP_DATA *idata, int oldmsgcount)

static body_cache_t *msg_cache_open(IMAP_DATA *idata)

static FILE *msg_cache_get(IMAP_DATA *idata, HEADER *h)

static FILE *msg_cache_put(IMAP_DATA *idata, HEADER *h)

static int msg_cache_commit(IMAP_DATA *idata, HEADER *h)

static int msg_cache_clean_cb(const char *id, body_cache_t *bcache, void *data)

static char *msg_parse_flags(IMAP_HEADER *h, char *s)

static int msg_parse_fetch(IMAP_HEADER *h, char *s)

static int msg_fetch_header(CONTEXT *ctx, IMAP_HEADER *h, char *buf, FILE *fp)

static void flush_buffer(char *buf, size_t *len, CONNECTION *conn)

int imap_read_headers(IMAP_DATA *idata, int msgbegin, int msgend)

int imap_fetch_message(CONTEXT *ctx, MESSAGE *msg, int msgno)

int imap_close_message(CONTEXT *ctx, MESSAGE *msg)

int imap_commit_message(CONTEXT *ctx, MESSAGE *msg)

int imap_append_message(CONTEXT *ctx, MESSAGE *msg)

int imap_copy_messages(CONTEXT *ctx, HEADER *h, char *dest, int delete)

int imap_cache_del(IMAP_DATA *idata, HEADER *h)

int imap_cache_clean(IMAP_DATA *idata)

void imap_add_keywords(char *s, HEADER *h, LIST *mailbox_flags, size_t slen)

void imap_free_header_data(IMAP_HEADER_DATA **data)

char *imap_set_flags(IMAP_DATA *idata, HEADER *h, char *s)

static char *utf7_to_utf8(const char *u7, size_t u7len, char **u8, size_t *u8len)

static char *utf8_to_utf7(const char *u8, size_t u8len, char **u7, size_t *u7len)

void imap_utf_encode(IMAP_DATA *idata, char **s)

void imap_utf_decode(IMAP_DATA *idata, char **s)

int imap_expand_path(char *path, size_t len)

void imap_get_parent(char *output, const char *mbox, size_t olen, char delim)

void imap_get_parent_path(char *output, const char *path, size_t olen)

void imap_clean_path(char *path, size_t plen)

static int imap_hcache_namer(const char *path, char *dest, size_t dlen)

header_cache_t *imap_hcache_open(IMAP_DATA *idata, const char *path)

void imap_hcache_close(IMAP_DATA *idata)

int imap_hcache_put(IMAP_DATA *idata, HEADER *h)

int imap_hcache_del(IMAP_DATA *idata, unsigned int uid)

int imap_parse_path(const char *path, IMAP_MBOX *mx)

int imap_mxcmp(const char *mx1, const char *mx2)

void imap_pretty_mailbox(char *path)

int imap_continue(const char *msg, const char *resp)

void imap_error(const char *where, const char *msg)

void imap_free_idata(IMAP_DATA **idata)

char *imap_fix_path(IMAP_DATA *idata, const char *mailbox, char *path, size_t plen)

void imap_cachepath(IMAP_DATA *idata, const char *mailbox, char *dest, size_t dlen)

int imap_get_literal_count(const char *buf, long *bytes)

char *imap_get_qualifier(char *buf)

char *imap_next_word(char *s)

time_t imap_parse_date(char *s)

void imap_make_date(char *buf, time_t timestamp)

void imap_qualify_path(char *dest, size_t len, IMAP_MBOX *mx, char *path)

void imap_quote_string(char *dest, size_t dlen, const char *src)

void imap_unquote_string(char *s)

void imap_munge_mbox_name(IMAP_DATA *idata, char *dest, size_t dlen, const char *src)

void imap_unmunge_mbox_name(IMAP_DATA *idata, char *s)

int imap_wordcasecmp(const char *a, const char *b)

static void alrm_handler(int sig)

void imap_keepalive(void)

int imap_wait_keepalive(pid_t pid)

void imap_allow_reopen(CONTEXT *ctx)

void imap_disallow_reopen(CONTEXT *ctx)

int imap_account_match(const ACCOUNT *a1, const ACCOUNT *a2)

static void myvar_set(const char *var, const char *val)

static void myvar_del(const char *var)

static void toggle_quadoption(int opt)

static int parse_regex(int idx, BUFFER *tmp, BUFFER *err)

void set_quadoption(int opt, int flag)

int quadoption(int opt)

int query_quadoption(int opt, const char *prompt)

int mutt_option_index(const char *s)

int mutt_option_to_string(const struct option_t *opt, char *val, size_t len)

const struct option_t *mutt_option_get(const char *s)

static void free_mbchar_table(mbchar_table **t)

static mbchar_table *parse_mbchar_table(const char *s)

static int parse_sort(short *val, const char *s, const struct mapping_t *map, BUFFER *err)

int mutt_option_set(const struct option_t *val, BUFFER *err)

static void free_opt(struct option_t *p)

void mutt_free_opts(void)

static void add_to_list(LIST **list, const char *str)

static RX_LIST *new_rx_list(void)

int mutt_add_to_rx_list(RX_LIST **list, const char *s, int flags, BUFFER *err)

static int remove_from_replace_list(REPLACE_LIST **list, const char *pat)

static REPLACE_LIST *new_replace_list(void)

static int add_to_replace_list(REPLACE_LIST **list, const char *pat,
                               const char *templ, BUFFER *err)

static void remove_from_list(LIST **l, const char *str)

static int finish_source(BUFFER *tmp, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_ifdef(BUFFER *tmp, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unignore(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_ignore(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_list(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static void _alternates_clean(void)

static int parse_alternates(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unalternates(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_replace_list(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unreplace_list(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static void clear_subject_mods(void)

static int parse_subjectrx_list(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unsubjectrx_list(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_spam_list(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unlist(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_path_list(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_path_unlist(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_lists(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_group(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static void _attachments_clean(void)

static int parse_attach_list(BUFFER *buf, BUFFER *s, LIST **ldata, BUFFER *err)

static int parse_unattach_list(BUFFER *buf, BUFFER *s, LIST **ldata, BUFFER *err)

static int print_attach_list(LIST *lp, char op, char *name)

static int parse_attachments(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unattachments(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unlists(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_subscribe(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unsubscribe(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unalias(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_alias(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_unmy_hdr(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_my_hdr(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static void set_default(struct option_t *p)

static void restore_default(struct option_t *p)

static size_t escape_string(char *dst, size_t len, const char *src)

static void pretty_var(char *dst, size_t len, const char *option, const char *val)

static int check_charset(struct option_t *opt, const char *val)

static bool valid_show_multipart_alternative(const char *val)

char **mutt_envlist(void)

void mutt_envlist_set(const char *name, const char *value, int overwrite)

static int parse_setenv(BUFFER *tmp, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_set(BUFFER *tmp, BUFFER *s, unsigned long data, BUFFER *err)

static int to_absolute_path(char *path, const char *reference)

static int source_rc(const char *rcfile_path, BUFFER *err)

static int parse_source(BUFFER *tmp, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_parse_rc_line(/* const */ char *line, BUFFER *token, BUFFER *err)

static void matches_ensure_morespace(int current)

static void matches_ensure_morespace(int current)

static void candidate(char *dest, char *try, const char *src, int len)

const struct command_t *mutt_command_get(const char *s)

void mutt_commands_apply(void *data, void (*application)(void *, const struct command_t *))

int mutt_command_complete(char *buffer, size_t len, int pos, int numtabs)

int mutt_var_value_complete(char *buffer, size_t len, int pos)

static int complete_all_nm_tags(const char *pt)

static const char *rstrnstr(const char *haystack, size_t haystack_length, const char *needle)

bool mutt_nm_query_complete(char *buffer, size_t len, int pos, int numtabs)

bool mutt_nm_tag_complete(char *buffer, size_t len, int pos, int numtabs)

int var_to_string(int idx, char *val, size_t len)

int mutt_query_variables(LIST *queries)

int mutt_dump_variables(int hide_sensitive)

const char *mutt_getnamebyvalue(int val, const struct mapping_t *map)

int mutt_getvaluebyname(const char *name, const struct mapping_t *map)

static void start_debug(void)

static int execute_commands(LIST *p)

static char *find_cfg(const char *home, const char *xdg_cfg_home)

void mutt_init(int skip_sys_rc, LIST *commands)

int mutt_get_hook_type(const char *name)

static int parse_group_context(group_context_t **ctx, BUFFER *buf, BUFFER *s,
                               unsigned long data, BUFFER *err)

static int parse_tag_transforms(BUFFER *b, BUFFER *s, unsigned long data, BUFFER *err)

static int parse_tag_formats(BUFFER *b, BUFFER *s, unsigned long data, BUFFER *err)

const char *myvar_get(const char *var)

int mutt_label_complete(char *buffer, size_t len, int numtabs)

static struct keymap_t *alloc_keys(int len, keycode_t *keys)

static int parse_fkey(char *s)

static int parse_keycode(const char *s)

static int parsekeys(const char *str, keycode_t *d, int max)

void km_bind(char *s, int menu, int op, char *macro, char *descr)

static void km_bindkey(char *s, int menu, int op)

static int get_op(const struct binding_t *bindings, const char *start, size_t len)

static char *get_func(const struct binding_t *bindings, int op)

static void generic_tokenize_push_string(char *s, void (*generic_push)(int, int))

static int retry_generic(int menu, keycode_t *keys, int keyslen, int lastkey)

int km_dokey(int menu)

static void create_bindings(const struct binding_t *map, int menu)

static const char *km_keyname(int c)

int km_expand_key(char *s, size_t len, struct keymap_t *map)

struct keymap_t *km_find_func(int menu, int func)

static const char *find_ext_name(const char *key)

void init_extended_keys(void)

void km_init(void)

void km_error_key(int menu)

int mutt_parse_push(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

char *parse_keymap(int *menu, BUFFER *s, int maxmenus, int *nummenus, BUFFER *err)

static int try_bind(char *key, int menu, char *func, const struct binding_t *bindings)

const struct binding_t *km_get_table(int menu)

int mutt_parse_bind(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_parse_macro(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_parse_exec(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

void mutt_what_key(void)

void mutt_nocurses_error(const char *fmt, ...)

void *safe_calloc(size_t nmemb, size_t size)

void *safe_malloc(size_t siz)

void safe_realloc(void *ptr, size_t siz)

void safe_free(void *ptr) /* __SAFE_FREE_CHECKED__ */

int safe_fclose(FILE **f)

int safe_fsync_close(FILE **f)

char *safe_strdup(const char *s)

char *safe_strcat(char *d, size_t l, const char *s)

char *safe_strncat(char *d, size_t l, const char *s, size_t sl)

void mutt_str_replace(char **p, const char *s)

void mutt_str_adjust(char **p)

char *mutt_strlower(char *s)

const char *mutt_strchrnul(const char *s, char c)

void mutt_unlink(const char *s)

int mutt_copy_bytes(FILE *in, FILE *out, size_t size)

int mutt_copy_stream(FILE *fin, FILE *fout)

static bool compare_stat(struct stat *osb, struct stat *nsb)

int safe_symlink(const char *oldpath, const char *newpath)

int safe_rename(const char *src, const char *target)

static int mkwrapdir(const char *path, char *newfile, size_t nflen, char *newdir, size_t ndlen)

int mutt_rmtree(const char *path)

static int put_file_in_place(const char *path, const char *safe_file, const char *safe_dir)

int safe_open(const char *path, int flags)

void mutt_sanitize_filename(char *f, short slash)

int mutt_rx_sanitize_string(char *dest, size_t destlen, const char *src)

char *mutt_read_line(char *s, size_t *size, FILE *fp, int *line, int flags)

char *mutt_substrcpy(char *dest, const char *beg, const char *end, size_t destlen)

char *mutt_substrdup(const char *begin, const char *end)

size_t mutt_quote_filename(char *d, size_t l, const char *f)

int mutt_strcmp(const char *a, const char *b)

int mutt_strcasecmp(const char *a, const char *b)

int mutt_strncmp(const char *a, const char *b, size_t l)

int mutt_strncasecmp(const char *a, const char *b, size_t l)

size_t mutt_strlen(const char *a)

int mutt_strcoll(const char *a, const char *b)

const char *mutt_stristr(const char *haystack, const char *needle)

char *mutt_skip_whitespace(char *p)

void mutt_remove_trailing_ws(char *s)

char *mutt_concatn_path(char *dst, size_t dstlen, const char *dir,
                        size_t dirlen, const char *fname, size_t fnamelen)

char *mutt_concat_path(char *d, const char *dir, const char *fname, size_t l)

const char *mutt_basename(const char *f)

const char *mutt_strsysexit(int e)

void mutt_debug(int level, const char *fmt, ...)

static int mutt_atol(const char *str, long *dst)

int mutt_atos(const char *str, short *dst)

int mutt_atoi(const char *str, int *dst)

int mutt_inbox_cmp(const char *a, const char *b)

char *strfcpy(char *dest, const char *src, size_t dlen)

int mutt_mkdir(const char *path, mode_t mode)

void mutt_exit(int code)

static void usage(void)

static void start_curses(void)

int main(int argc, char **argv, char **environ)

static int mbox_lock_mailbox(CONTEXT *ctx, int excl, int retry)

static void mbox_unlock_mailbox(CONTEXT *ctx)

static int mmdf_parse_mailbox(CONTEXT *ctx)

static int mbox_parse_mailbox(CONTEXT *ctx)

static int mbox_open_mailbox(CONTEXT *ctx)

static int mbox_open_mailbox_append(CONTEXT *ctx, int flags)

static int mbox_close_mailbox(CONTEXT *ctx)

static int mbox_open_message(CONTEXT *ctx, MESSAGE *msg, int msgno)

static int mbox_close_message(CONTEXT *ctx, MESSAGE *msg)

static int mbox_commit_message(CONTEXT *ctx, MESSAGE *msg)

static int mmdf_commit_message(CONTEXT *ctx, MESSAGE *msg)

static int mbox_open_new_message(MESSAGE *msg, CONTEXT *dest, HEADER *hdr)

static int strict_addrcmp(const ADDRESS *a, const ADDRESS *b)

static int strict_cmp_lists(const LIST *a, const LIST *b)

static int strict_cmp_envelopes(const ENVELOPE *e1, const ENVELOPE *e2)

static int strict_cmp_parameters(const PARAMETER *p1, const PARAMETER *p2)

static int strict_cmp_bodies(const BODY *b1, const BODY *b2)

int mbox_strict_cmp_headers(const HEADER *h1, const HEADER *h2)

static int reopen_mailbox(CONTEXT *ctx, int *index_hint)

static int mbox_check_mailbox(CONTEXT *ctx, int *index_hint)

static bool mbox_has_new(CONTEXT *ctx)

void mbox_reset_atime(CONTEXT *ctx, struct stat *st)

static int mbox_sync_mailbox(CONTEXT *ctx, int *index_hint)

int mbox_check_empty(const char *path)

void mutt_set_charset(char *charset)

static size_t utf8rtowc(wchar_t *pwc, const char *s, size_t n, mbstate_t *_ps)

static size_t wcrtomb_iconv(char *s, wchar_t wc, iconv_t cd)

size_t wcrtomb(char *s, wchar_t wc, mbstate_t *ps)

static size_t mbrtowc_iconv(wchar_t *pwc, const char *s, size_t n, mbstate_t *ps, iconv_t cd)

size_t mbrtowc(wchar_t *pwc, const char *s, size_t n, mbstate_t *ps)

int iswprint(wint_t wc)

int iswspace(wint_t wc)

static wint_t towupper_ucs(wint_t x)

static int iswupper_ucs(wint_t x)

static wint_t towlower_ucs(wint_t x)

static int iswalnum_ucs(wint_t wc)

static int iswalpha_ucs(wint_t wc)

wint_t towupper(wint_t wc)

wint_t towlower(wint_t wc)

int iswalnum(wint_t wc)

int iswalpha(wint_t wc)

int iswupper(wint_t wc)

static int wcwidth_ja(wchar_t ucs)

int wcwidth(wchar_t wc)

wchar_t replacement_char(void)

bool is_display_corrupting_utf8(wchar_t wc)

int mutt_filter_unprintable(char **s)

void md5_init_ctx(struct md5_ctx *ctx)

static inline void set_uint32(char *cp, md5_uint32 v)

void *md5_read_ctx(const struct md5_ctx *ctx, void *resbuf)

void *md5_finish_ctx(struct md5_ctx *ctx, void *resbuf)

int md5_stream(FILE *stream, void *resblock)

void *md5_buffer(const char *buffer, size_t len, void *resblock)

void md5_process_bytes(const void *buffer, size_t len, struct md5_ctx *ctx)

void md5_process_block(const void *buffer, size_t len, struct md5_ctx *ctx)

int main(void)

static int get_color(int index, unsigned char *s)

static void print_enriched_string(int index, int attr, unsigned char *s, int do_color)

static void menu_make_entry(char *s, int l, MUTTMENU *menu, int i)

static void menu_pad_string(MUTTMENU *menu, char *s, size_t n)

void menu_redraw_full(MUTTMENU *menu)

void menu_redraw_status(MUTTMENU *menu)

void menu_redraw_sidebar(MUTTMENU *menu)

void menu_redraw_index(MUTTMENU *menu)

void menu_redraw_motion(MUTTMENU *menu)

void menu_redraw_current(MUTTMENU *menu)

static void menu_redraw_prompt(MUTTMENU *menu)

void menu_check_recenter(MUTTMENU *menu)

static void menu_jump(MUTTMENU *menu)

void menu_next_line(MUTTMENU *menu)

void menu_prev_line(MUTTMENU *menu)

static void menu_length_jump(MUTTMENU *menu, int jumplen)

void menu_next_page(MUTTMENU *menu)

void menu_prev_page(MUTTMENU *menu)

void menu_half_down(MUTTMENU *menu)

void menu_half_up(MUTTMENU *menu)

void menu_top_page(MUTTMENU *menu)

void menu_bottom_page(MUTTMENU *menu)

void menu_middle_page(MUTTMENU *menu)

void menu_first_entry(MUTTMENU *menu)

void menu_last_entry(MUTTMENU *menu)

void menu_current_top(MUTTMENU *menu)

void menu_current_middle(MUTTMENU *menu)

void menu_current_bottom(MUTTMENU *menu)

static void menu_next_entry(MUTTMENU *menu)

static void menu_prev_entry(MUTTMENU *menu)

static int default_color(int i)

static int menu_search_generic(MUTTMENU *m, regex_t *re, int n)

void mutt_menu_init(void)

void mutt_menu_destroy(MUTTMENU **p)

static MUTTMENU *get_current_menu(void)

void mutt_push_current_menu(MUTTMENU *menu)

void mutt_pop_current_menu(MUTTMENU *menu)

void mutt_set_current_menu_redraw(int redraw)

void mutt_set_current_menu_redraw_full(void)

void mutt_set_menu_redraw_full(int menu_type)

void mutt_current_menu_redraw()

static int menu_search(MUTTMENU *menu, int op)

static int menu_dialog_translate_op(int i)

static int menu_dialog_dokey(MUTTMENU *menu, int *ip)

int menu_redraw(MUTTMENU *menu)

int mutt_menu_loop(MUTTMENU *menu)

static inline struct mh_data *mh_data(CONTEXT *ctx)

static void mhs_alloc(struct mh_sequences *mhs, int i)

static void mhs_free_sequences(struct mh_sequences *mhs)

static short mhs_check(struct mh_sequences *mhs, int i)

static short mhs_set(struct mh_sequences *mhs, int i, short f)

static int mh_read_token(char *t, int *first, int *last)

static int mh_read_sequences(struct mh_sequences *mhs, const char *path)

static inline mode_t mh_umask(CONTEXT *ctx)

static int mh_sequences_changed(BUFFY *b)

static int mh_already_notified(BUFFY *b, int msgno)

static bool mh_valid_message(const char *s)

int mh_buffy(BUFFY *mailbox, int check_stats)

static int mh_mkstemp(CONTEXT *dest, FILE **fp, char **tgt)

static void mhs_write_one_sequence(FILE *fp, struct mh_sequences *mhs, short f,
                                   const char *tag)

static void mh_update_sequences(CONTEXT *ctx)

static void mh_sequences_add_one(CONTEXT *ctx, int n, short unseen, short flagged, short replied)

static void mh_update_maildir(struct maildir *md, struct mh_sequences *mhs)

static void maildir_free_entry(struct maildir **md)

static void maildir_free_maildir(struct maildir **md)

void maildir_parse_flags(HEADER *h, const char *path)

static void maildir_update_mtime(CONTEXT *ctx)

static int maildir_parse_dir(CONTEXT *ctx, struct maildir ***last,
                             const char *subdir, int *count, progress_t *progress)

static bool maildir_add_to_context(CONTEXT *ctx, struct maildir *md)

static int maildir_move_to_context(CONTEXT *ctx, struct maildir **md)

static size_t maildir_hcache_keylen(const char *fn)

static int md_cmp_inode(struct maildir *a, struct maildir *b)

static int md_cmp_path(struct maildir *a, struct maildir *b)

static struct maildir *maildir_merge_lists(struct maildir *left, struct maildir *right,
                                           int (*cmp)(struct maildir *, struct maildir *))

static struct maildir *maildir_ins_sort(struct maildir *list,
                                        int (*cmp)(struct maildir *, struct maildir *))

static struct maildir *maildir_sort(struct maildir *list, size_t len,
                                    int (*cmp)(struct maildir *, struct maildir *))

static void mh_sort_natural(CONTEXT *ctx, struct maildir **md)

static struct maildir *skip_duplicates(struct maildir *p, struct maildir **last)

static void maildir_delayed_parsing(CONTEXT *ctx, struct maildir **md, progress_t *progress)

static int mh_close_mailbox(CONTEXT *ctx)

static int mh_read_dir(CONTEXT *ctx, const char *subdir)

static int maildir_read_dir(CONTEXT *ctx)

static int maildir_open_mailbox(CONTEXT *ctx)

static int maildir_open_mailbox_append(CONTEXT *ctx, int flags)

static int mh_open_mailbox(CONTEXT *ctx)

static int mh_open_mailbox_append(CONTEXT *ctx, int flags)

static int mh_open_new_message(MESSAGE *msg, CONTEXT *dest, HEADER *hdr)

static int ch_compar(const void *a, const void *b)

void maildir_flags(char *dest, size_t destlen, HEADER *hdr)

static int maildir_mh_open_message(CONTEXT *ctx, MESSAGE *msg, int msgno, int is_maildir)

static int maildir_open_message(CONTEXT *ctx, MESSAGE *msg, int msgno)

static int mh_open_message(CONTEXT *ctx, MESSAGE *msg, int msgno)

static int mh_close_message(CONTEXT *ctx, MESSAGE *msg)

static int maildir_open_new_message(MESSAGE *msg, CONTEXT *dest, HEADER *hdr)

static int _maildir_commit_message(CONTEXT *ctx, MESSAGE *msg, HEADER *hdr)

static int maildir_commit_message(CONTEXT *ctx, MESSAGE *msg)

static int _mh_commit_message(CONTEXT *ctx, MESSAGE *msg, HEADER *hdr, short updseq)

static int mh_commit_message(CONTEXT *ctx, MESSAGE *msg)

static int mh_rewrite_message(CONTEXT *ctx, int msgno)

static int mh_sync_message(CONTEXT *ctx, int msgno)

static int maildir_sync_message(CONTEXT *ctx, int msgno)

int mh_sync_mailbox_message(CONTEXT *ctx, int msgno, header_cache_t *hc)

int mh_sync_mailbox_message(CONTEXT *ctx, int msgno)

static char *maildir_canon_filename(char *dest, const char *src, size_t l)

static void maildir_update_tables(CONTEXT *ctx, int *index_hint)

static int maildir_check_mailbox(CONTEXT *ctx, int *index_hint)

static int mh_check_mailbox(CONTEXT *ctx, int *index_hint)

static int mh_sync_mailbox(CONTEXT *ctx, int *index_hint)

void maildir_update_flags(CONTEXT *ctx, HEADER *o, HEADER *n)

static FILE *_maildir_open_find_message(const char *folder, const char *unique,
                                        const char *subfolder, char **newname)

int maildir_check_empty(const char *path)

int mh_check_empty(const char *path)

bool mx_is_maildir(const char *path)

bool mx_is_mh(const char *path)

static bool check_idn(char *domain)

static int mbox_to_udomain(const char *mbx, char **user, char **domain)

static int addr_is_local(ADDRESS *a)

static int addr_is_intl(ADDRESS *a)

static void set_local_mailbox(ADDRESS *a, char *local_mailbox)

static void set_intl_mailbox(ADDRESS *a, char *intl_mailbox)

static char *intl_to_local(char *orig_user, char *orig_domain, int flags)

static char *local_to_intl(char *user, char *domain)

int mutt_addrlist_to_intl(ADDRESS *a, char **err)

int mutt_addrlist_to_local(ADDRESS *a)

const char *mutt_addr_for_display(ADDRESS *a)

void mutt_env_to_local(ENVELOPE *e)

int mutt_env_to_intl(ENVELOPE *env, char **tag, char **err)

void mutt_adv_mktemp(char *s, size_t l)

int mutt_copy_body(FILE *fp, BODY **tgt, BODY *src)

void mutt_free_body(BODY **p)

void mutt_free_parameter(PARAMETER **p)

void mutt_push_list(LIST **head, const char *data)

bool mutt_pop_list(LIST **head)

const char *mutt_front_list(LIST *head)

int mutt_remove_from_rx_list(RX_LIST **l, const char *str)

void mutt_free_list(LIST **list)

void mutt_free_header(HEADER **h)

bool mutt_matches_list(const char *s, LIST *t)

int mutt_matches_ignore(const char *s)

char *mutt_expand_path(char *s, size_t slen)

char *_mutt_expand_path(char *s, size_t slen, int rx)

char *mutt_gecos_name(char *dest, size_t destlen, struct passwd *pw)

char *mutt_get_parameter(const char *s, PARAMETER *p)

void mutt_set_parameter(const char *attribute, const char *value, PARAMETER **p)

void mutt_delete_parameter(const char *attribute, PARAMETER **p)

bool mutt_needs_mailcap(BODY *m)

bool mutt_is_text_part(BODY *b)

void mutt_free_envelope(ENVELOPE **p)

void mutt_merge_envelopes(ENVELOPE *base, ENVELOPE **extra)

static void mutt_randbuf(void *out, size_t len)

void mutt_rand_base32(void *out, size_t len)

uint32_t mutt_rand32(void)

uint64_t mutt_rand64(void)

void _mutt_mktemp(char *s, size_t slen, const char *prefix, const char *suffix,
                  const char *src, int line)

void mutt_free_alias(ALIAS **p)

void mutt_pretty_mailbox(char *s, size_t buflen)

void mutt_pretty_size(char *s, size_t len, LOFF_T n)

void mutt_expand_file_fmt(char *dest, size_t destlen, const char *fmt, const char *src)

void mutt_expand_fmt(char *dest, size_t destlen, const char *fmt, const char *src)

int mutt_check_overwrite(const char *attname, const char *path, char *fname,
                         size_t flen, int *append, char **directory)

void mutt_save_path(char *d, size_t dsize, ADDRESS *a)

void mutt_safe_path(char *s, size_t l, ADDRESS *a)

char *mutt_apply_replace(char *dbuf, size_t dlen, char *sbuf, REPLACE_LIST *rlist)

void mutt_FormatString(char *dest,     /* output buffer */
                       size_t destlen, /* output buffer len */
                       size_t col, /* starting column (nonzero when called recursively) */
                       int cols,           /* maximum columns */
                       const char *src,    /* template string */
                       format_t *callback, /* callback for processing */
                       unsigned long data, /* callback data */
                       format_flag flags)  /* callback flags */

int mutt_save_confirm(const char *s, struct stat *st)

void state_prefix_putc(char c, STATE *s)

int state_printf(STATE *s, const char *fmt, ...)

void state_mark_attach(STATE *s)

void state_attach_puts(const char *t, STATE *s)

static int state_putwc(wchar_t wc, STATE *s)

int state_putws(const wchar_t *ws, STATE *s)

void mutt_sleep(short s)

time_t mutt_decrease_mtime(const char *f, struct stat *st)

void mutt_set_mtime(const char *from, const char *to)

void mutt_touch_atime(int f)

const char *mutt_make_version(void)

void mutt_free_regexp(REGEXP **pp)

void mutt_free_rx_list(RX_LIST **list)

void mutt_free_replace_list(REPLACE_LIST **list)

bool mutt_match_rx_list(const char *s, RX_LIST *l)

bool mutt_match_spam_list(const char *s, REPLACE_LIST *l, char *text, int textsize)

void mutt_encode_path(char *dest, size_t dlen, const char *src)

int mutt_set_xdg_path(const XDGType type, char *buf, size_t bufsize)

void mutt_get_parent_path(char *output, char *path, size_t olen)

static int _handle_panic(lua_State *l)

static int _handle_error(lua_State *l)

static int _lua_mutt_call(lua_State *l)

static int _lua_mutt_set(lua_State *l)

static int _lua_mutt_get(lua_State *l)

static int _lua_mutt_enter(lua_State *l)

static int _lua_mutt_message(lua_State *l)

static int _lua_mutt_error(lua_State *l)

static void _lua_expose_command(void *p, const struct command_t *cmd)

static int luaopen_mutt_decl(lua_State *l)

static void luaopen_mutt(lua_State *l)

static bool _lua_init(lua_State **l)

int mutt_lua_parse(BUFFER *tmp, BUFFER *s, unsigned long data, BUFFER *err)

int mutt_lua_source_file(BUFFER *tmp, BUFFER *s, unsigned long data, BUFFER *err)

static void debug_print_filenames(notmuch_message_t *msg)

static void debug_print_tags(notmuch_message_t *msg)

static void url_free_tags(struct uri_tag *tags)

static bool url_parse_query(const char *url, char **filename, struct uri_tag **tags)

static void free_tag_list(struct nm_hdrtag **tag_list)

static void free_hdrdata(struct nm_hdrdata *data)

static void free_ctxdata(struct nm_ctxdata *data)

static struct nm_ctxdata *new_ctxdata(char *uri)

static int init_context(CONTEXT *ctx)

static char *header_get_id(HEADER *h)

static char *header_get_fullpath(HEADER *h, char *buf, size_t bufsz)

static struct nm_ctxdata *get_ctxdata(CONTEXT *ctx)

static int string_to_query_type(const char *str)

static bool query_window_check_timebase(const char *timebase)

static void query_window_reset(void)

static bool windowed_query_from_query(const char *query, char *buf, size_t bufsz)

static char *get_query_string(struct nm_ctxdata *data, int window)

static int get_limit(struct nm_ctxdata *data)

static int get_query_type(struct nm_ctxdata *data)

static const char *get_db_filename(struct nm_ctxdata *data)

static notmuch_database_t *do_database_open(const char *filename, int writable, int verbose)

static notmuch_database_t *get_db(struct nm_ctxdata *data, int writable)

static int release_db(struct nm_ctxdata *data)

static int db_trans_begin(struct nm_ctxdata *data)

static int db_trans_end(struct nm_ctxdata *data)

static int is_longrun(struct nm_ctxdata *data)

static int get_database_mtime(struct nm_ctxdata *data, time_t *mtime)

static void apply_exclude_tags(notmuch_query_t *query)

static notmuch_query_t *get_query(struct nm_ctxdata *data, int writable)

static void append_str_item(char **str, const char *item, int sep)

static int update_header_tags(HEADER *h, notmuch_message_t *msg)

static int update_message_path(HEADER *h, const char *path)

static char *get_folder_from_path(const char *path)

static void deinit_header(HEADER *h)

static char *nm2mutt_message_id(const char *id)

static int init_header(HEADER *h, const char *path, notmuch_message_t *msg)

static const char *get_message_last_filename(notmuch_message_t *msg)

static void progress_reset(CONTEXT *ctx)

static void progress_update(CONTEXT *ctx, notmuch_query_t *q)

static HEADER *get_mutt_header(CONTEXT *ctx, notmuch_message_t *msg)

static void append_message(CONTEXT *ctx, notmuch_query_t *q, notmuch_message_t *msg, int dedup)

static void append_replies(CONTEXT *ctx, notmuch_query_t *q, notmuch_message_t *top, int dedup)

static void append_thread(CONTEXT *ctx, notmuch_query_t *q, notmuch_thread_t *thread, int dedup)

static bool read_mesgs_query(CONTEXT *ctx, notmuch_query_t *q, int dedup)

static bool read_threads_query(CONTEXT *ctx, notmuch_query_t *q, int dedup, int limit)

static notmuch_message_t *get_nm_message(notmuch_database_t *db, HEADER *hdr)

static bool nm_message_has_tag(notmuch_message_t *msg, char *tag)

static int update_tags(notmuch_message_t *msg, const char *tags)

static int update_header_flags(CONTEXT *ctx, HEADER *hdr, const char *tags)

static int rename_maildir_filename(const char *old, char *newpath, size_t newsz, HEADER *h)

static int remove_filename(struct nm_ctxdata *data, const char *path)

static int rename_filename(struct nm_ctxdata *data, const char *old,
                           const char *new, HEADER *h)

static unsigned count_query(notmuch_database_t *db, const char *qstr)

char *nm_header_get_folder(HEADER *h)

char *nm_header_get_tags(HEADER *h)

char *nm_header_get_tags_transformed(HEADER *h)

char *nm_header_get_tag_transformed(char *tag, HEADER *h)

void nm_longrun_init(CONTEXT *ctx, int writable)

void nm_longrun_done(CONTEXT *ctx)

void nm_debug_check(CONTEXT *ctx)

int nm_read_entire_thread(CONTEXT *ctx, HEADER *h)

char *nm_uri_from_query(CONTEXT *ctx, char *buf, size_t bufsz)

bool nm_normalize_uri(char *new_uri, const char *orig_uri, size_t new_uri_sz)

void nm_query_window_forward(void)

void nm_query_window_backward(void)

int nm_modify_message_tags(CONTEXT *ctx, HEADER *hdr, char *buf)

int nm_update_filename(CONTEXT *ctx, const char *old, const char *new, HEADER *h)

int nm_nonctx_get_count(char *path, int *all, int *new)

char *nm_get_description(CONTEXT *ctx)

int nm_description_to_path(const char *desc, char *buf, size_t bufsz)

int nm_record_message(CONTEXT *ctx, char *path, HEADER *h)

int nm_get_all_tags(CONTEXT *ctx, char **tag_list, int *tag_count)

static int nm_open_mailbox(CONTEXT *ctx)

static int nm_close_mailbox(CONTEXT *ctx)

static int nm_check_mailbox(CONTEXT *ctx, int *index_hint)

static int nm_sync_mailbox(CONTEXT *ctx, int *index_hint)

static int nm_open_message(CONTEXT *ctx, MESSAGE *msg, int msgno)

static int nm_close_message(CONTEXT *ctx, MESSAGE *msg)

static int nm_commit_message(CONTEXT *ctx, MESSAGE *msg)

static int getnameinfo_err(int ret)

static int iptostring(const struct sockaddr *addr, socklen_t addrlen, char *out, unsigned outlen)

static int mutt_sasl_cb_log(void *context, int priority, const char *message)

static int mutt_sasl_start(void)

static int mutt_sasl_cb_authname(void *context, int id, const char **result, unsigned *len)

static int mutt_sasl_cb_pass(sasl_conn_t *conn, void *context, int id, sasl_secret_t **psecret)

static sasl_callback_t *mutt_sasl_get_callbacks(ACCOUNT *account)

int mutt_sasl_client_new(CONNECTION *conn, sasl_conn_t **saslconn)

int mutt_sasl_interact(sasl_interact_t *interaction)

static int mutt_sasl_conn_open(CONNECTION *conn)

static int mutt_sasl_conn_close(CONNECTION *conn)

static int mutt_sasl_conn_read(CONNECTION *conn, char *buf, size_t len)

static int mutt_sasl_conn_write(CONNECTION *conn, const char *buf, size_t len)

static int mutt_sasl_conn_poll(CONNECTION *conn)

void mutt_sasl_setup_conn(CONNECTION *conn, sasl_conn_t *saslconn)

void mutt_sasl_done(void)

size_t mutt_sasl_plain_msg(char *buf, size_t buflen, const char *cmd,
                           const char *authz, const char *user, const char *pass)

static int socket_preconnect(void)

int mutt_socket_open(CONNECTION *conn)

int mutt_socket_close(CONNECTION *conn)

int mutt_socket_write_d(CONNECTION *conn, const char *buf, int len, int dbg)

int mutt_socket_poll(CONNECTION *conn)

int mutt_socket_readchar(CONNECTION *conn, char *c)

int mutt_socket_readln_d(char *buf, size_t buflen, CONNECTION *conn, int dbg)

void mutt_socket_free(CONNECTION *conn)

static CONNECTION *socket_new_conn(void)

int raw_socket_close(CONNECTION *conn)

int raw_socket_read(CONNECTION *conn, char *buf, size_t len)

int raw_socket_write(CONNECTION *conn, const char *buf, size_t count)

int raw_socket_poll(CONNECTION *conn)

static int socket_connect(int fd, struct sockaddr *sa)

int raw_socket_open(CONNECTION *conn)

static int ssl_load_certificates(SSL_CTX *ctx)

static int ssl_set_verify_partial(SSL_CTX *ctx)

static int add_entropy(const char *file)

static void ssl_err(sslsockdata *data, int err)

static void ssl_dprint_err_stack(void)

static int ssl_passwd_cb(char *buf, int size, int rwflag, void *userdata)

static int ssl_socket_open_err(CONNECTION *conn)

static int ssl_socket_close(CONNECTION *conn)

static char *x509_get_part(X509_NAME *name, int nid)

static void x509_fingerprint(char *s, int l, X509 *cert, const EVP_MD *(*hashfunc)(void) )

static char *asn1time_to_string(ASN1_UTCTIME *tm)

static bool compare_certificates(X509 *cert, X509 *peercert,
                                 unsigned char *peermd, unsigned int peermdlen)

static bool check_certificate_expiration(X509 *peercert, bool silent)

static bool hostname_match(const char *hostname, const char *certname)

static int ssl_init(void)

static int ssl_socket_read(CONNECTION *conn, char *buf, size_t len)

static int ssl_socket_write(CONNECTION *conn, const char *buf, size_t len)

static void ssl_get_client_cert(sslsockdata *ssldata, CONNECTION *conn)

static int tls_close(CONNECTION *conn)

static bool check_certificate_cache(X509 *peercert)

static int check_certificate_file(X509 *peercert)

static int check_host(X509 *x509cert, const char *hostname, char *err, size_t errlen)

static int check_certificate_by_digest(X509 *peercert)

static int ssl_cache_trusted_cert(X509 *c)

static int interactive_check_cert(X509 *cert, int idx, int len, SSL *ssl, int allow_always)

static int ssl_verify_callback(int preverify_ok, X509_STORE_CTX *ctx)

static int ssl_negotiate(CONNECTION *conn, sslsockdata *ssldata)

static int ssl_socket_open(CONNECTION *conn)

int mutt_ssl_starttls(CONNECTION *conn)

int mutt_ssl_socket_setup(CONNECTION *conn)

static int tls_init(void)

static int tls_socket_read(CONNECTION *conn, char *buf, size_t len)

static int tls_socket_write(CONNECTION *conn, const char *buf, size_t len)

static int tls_socket_close(CONNECTION *conn)

static int tls_starttls_close(CONNECTION *conn)

static gnutls_certificate_status_t tls_verify_peers(gnutls_session_t tlsstate)

static void tls_fingerprint(gnutls_digest_algorithm_t algo, char *s, int l,
                            const gnutls_datum_t *data)

static int tls_check_stored_hostname(const gnutls_datum_t *cert, const char *hostname)

static int tls_compare_certificates(const gnutls_datum_t *peercert)

static int tls_check_preauth(const gnutls_datum_t *certdata,
                             gnutls_certificate_status_t certstat, const char *hostname,
                             int chainidx, int *certerr, int *savedcert)

static char *tls_make_date(time_t t, char *s, size_t len)

static int tls_check_one_certificate(const gnutls_datum_t *certdata,
                                     gnutls_certificate_status_t certstat,
                                     const char *hostname, int idx, int len)

static int tls_check_certificate(CONNECTION *conn)

static void tls_get_client_cert(CONNECTION *conn)

static int tls_set_priority(tlssockdata *data)

static int tls_set_priority(tlssockdata *data)

static int tls_negotiate(CONNECTION *conn)

static int tls_socket_open(CONNECTION *conn)

int mutt_ssl_socket_setup(CONNECTION *conn)

int mutt_ssl_starttls(CONNECTION *conn)

static int tunnel_socket_open(CONNECTION *conn)

static int tunnel_socket_close(CONNECTION *conn)

static int tunnel_socket_read(CONNECTION *conn, char *buf, size_t len)

static int tunnel_socket_write(CONNECTION *conn, const char *buf, size_t len)

static int tunnel_socket_poll(CONNECTION *conn)

int mutt_tunnel_socket_setup(CONNECTION *conn)

struct mx_ops *mx_get_ops(int magic)

static int invoke_dotlock(const char *path, int dummy, int flags, int retry)

static int dotlock_file(const char *path, int fd, int retry)

static int undotlock_file(const char *path, int fd)

int mx_lock_file(const char *path, int fd, int excl, int dot, int timeout)

int mx_unlock_file(const char *path, int fd, int dot)

static void mx_unlink_empty(const char *path)

bool mx_is_imap(const char *p)

bool mx_is_pop(const char *p)

bool mx_is_nntp(const char *p)

bool mx_is_notmuch(const char *p)

int mx_get_magic(const char *path)

int mx_set_magic(const char *s)

int mx_access(const char *path, int flags)

static int mx_open_mailbox_append(CONTEXT *ctx, int flags)

void mx_fastclose_mailbox(CONTEXT *ctx)

static int sync_mailbox(CONTEXT *ctx, int *index_hint)

static int trash_append(CONTEXT *ctx)

int mx_close_mailbox(CONTEXT *ctx, int *index_hint)

void mx_update_tables(CONTEXT *ctx, int committing)

int mx_sync_mailbox(CONTEXT *ctx, int *index_hint)

int mx_check_mailbox(CONTEXT *ctx, int *index_hint)

int mx_commit_message(MESSAGE *msg, CONTEXT *ctx)

int mx_close_message(CONTEXT *ctx, MESSAGE **msg)

void mx_alloc_memory(CONTEXT *ctx)

void mx_update_context(CONTEXT *ctx, int new_messages)

int mx_check_empty(const char *path)

static NNTP_DATA *nntp_data_find(NNTP_SERVER *nserv, const char *group)

void nntp_acache_free(NNTP_DATA *nntp_data)

void nntp_data_free(void *data)

void nntp_newsrc_close(NNTP_SERVER *nserv)

void nntp_group_unread_stat(NNTP_DATA *nntp_data)

int nntp_newsrc_parse(NNTP_SERVER *nserv)

void nntp_newsrc_gen_entries(CONTEXT *ctx)

static int update_file(char *filename, char *buf)

int nntp_newsrc_update(NNTP_SERVER *nserv)

static void cache_expand(char *dst, size_t dstlen, ACCOUNT *acct, char *src)

void nntp_expand_path(char *line, size_t len, ACCOUNT *acct)

int nntp_add_group(char *line, void *data)

static int active_get_cache(NNTP_SERVER *nserv)

int nntp_active_save_cache(NNTP_SERVER *nserv)

static int nntp_hcache_namer(const char *path, char *dest, size_t destlen)

header_cache_t *nntp_hcache_open(NNTP_DATA *nntp_data)

void nntp_hcache_update(NNTP_DATA *nntp_data, header_cache_t *hc)

static int nntp_bcache_delete(const char *id, body_cache_t *bcache, void *data)

void nntp_bcache_update(NNTP_DATA *nntp_data)

void nntp_delete_group_cache(NNTP_DATA *nntp_data)

void nntp_clear_cache(NNTP_SERVER *nserv)

const char *nntp_format_str(char *dest, size_t destlen, size_t col, int cols, char op,
                            const char *src, const char *fmt, const char *ifstring,
                            const char *elsestring, unsigned long data, format_flag flags)

void nntp_article_status(CONTEXT *ctx, HEADER *hdr, char *group, anum_t anum)

void nntp_buffy(char *buf, size_t len)

static int nntp_connect_error(NNTP_SERVER *nserv)

static int nntp_capabilities(NNTP_SERVER *nserv)

static int nntp_attempt_features(NNTP_SERVER *nserv)

static int nntp_auth(NNTP_SERVER *nserv)

int nntp_open_connection(NNTP_SERVER *nserv)

static int nntp_query(NNTP_DATA *nntp_data, char *line, size_t linelen)

static int nntp_fetch_lines(NNTP_DATA *nntp_data, char *query, size_t qlen,
                            char *msg, int (*funct)(char *, void *), void *data)

static int fetch_description(char *line, void *data)

static int get_description(NNTP_DATA *nntp_data, char *wildmat, char *msg)

static void nntp_parse_xref(CONTEXT *ctx, HEADER *hdr)

static int fetch_tempfile(char *line, void *data)

static int fetch_numbers(char *line, void *data)

static int parse_overview_line(char *line, void *data)

static int nntp_fetch_headers(CONTEXT *ctx, void *hc, anum_t first, anum_t last, int restore)

static int nntp_open_mailbox(CONTEXT *ctx)

static int nntp_fetch_message(CONTEXT *ctx, MESSAGE *msg, int msgno)

static int nntp_close_message(CONTEXT *ctx, MESSAGE *msg)

int nntp_post(const char *msg)

static int nntp_group_poll(NNTP_DATA *nntp_data, int update_stat)

static int nntp_check_mailbox(CONTEXT *ctx, int *index_hint)

static int nntp_sync_mailbox(CONTEXT *ctx, int *index_hint)

static int nntp_fastclose_mailbox(CONTEXT *ctx)

static int nntp_date(NNTP_SERVER *nserv, time_t *now)

int nntp_active_fetch(NNTP_SERVER *nserv)

int nntp_check_new_groups(NNTP_SERVER *nserv)

int nntp_check_msgid(CONTEXT *ctx, const char *msgid)

static int fetch_children(char *line, void *data)

int nntp_check_children(CONTEXT *ctx, const char *msgid)

static int check_sig(const char *s, struct line_t *info, int n)

static void resolve_color(struct line_t *lineInfo, int n, int cnt, int flags,
                          int special, ansi_attr *a)

static void append_line(struct line_t *lineInfo, int n, int cnt)

static void new_class_color(struct q_class_t *class, int *q_level)

static void shift_class_colors(struct q_class_t *QuoteList,
                               struct q_class_t *new_class, int index, int *q_level)

static void cleanup_quote(struct q_class_t **QuoteList)

static struct q_class_t *classify_quote(struct q_class_t **QuoteList, const char *qptr,
                                        int length, int *force_redraw, int *q_level)

static int check_attachment_marker(char *p)

static void resolve_types(char *buf, char *raw, struct line_t *lineInfo, int n,
                          int last, struct q_class_t **QuoteList, int *q_level,
                          int *force_redraw, int q_classify)

static int is_ansi(unsigned char *buf)

static int grok_ansi(unsigned char *buf, int pos, ansi_attr *a)

static int trim_incomplete_mbyte(unsigned char *buf, size_t len)

static int fill_buffer(FILE *f, LOFF_T *last_pos, LOFF_T offset, unsigned char **buf,
                       unsigned char **fmt, size_t *blen, int *buf_ready)

static int format_line(struct line_t **lineInfo, int n, unsigned char *buf,
                       int flags, ansi_attr *pa, int cnt, int *pspace, int *pvch,
                       int *pcol, int *pspecial, mutt_window_t *pager_window)

static int display_line(FILE *f, LOFF_T *last_pos, struct line_t **lineInfo,
                        int n, int *last, int *max, int flags,
                        struct q_class_t **QuoteList, int *q_level, int *force_redraw,
                        regex_t *SearchRE, mutt_window_t *pager_window)

static int up_n_lines(int nlines, struct line_t *info, int cur, int hiding)

void mutt_clear_pager_position(void)

static void pager_menu_redraw(MUTTMENU *pager_menu)

int mutt_pager(const char *banner, const char *fname, int flags, pager_t *extra)

char *mutt_read_rfc822_line(FILE *f, char *line, size_t *linelen)

static LIST *parse_references(char *s, int in_reply_to)

int mutt_check_encoding(const char *c)

static PARAMETER *parse_parameters(const char *s)

int mutt_check_mime_type(const char *s)

void mutt_parse_content_type(char *s, BODY *ct)

static void parse_content_disposition(const char *s, BODY *ct)

void mutt_parse_part(FILE *fp, BODY *b)

static const char *uncomment_timezone(char *buf, size_t buflen, const char *tz)

time_t mutt_parse_date(const char *s, HEADER *h)

char *mutt_extract_message_id(const char *s, const char **saveptr)

void mutt_parse_mime_message(CONTEXT *ctx, HEADER *cur)

int mutt_parse_rfc822_line(ENVELOPE *e, HEADER *hdr, char *line, char *p,
                           short user_hdrs, short weed, short do_2047, LIST **lastp)

static bool count_body_parts_check(LIST **checklist, BODY *b, bool dflt)

static int count_body_parts(BODY *body, int flags)

int mutt_count_body_parts(CONTEXT *ctx, HEADER *hdr)

static bool eat_regexp(pattern_t *pat, BUFFER *s, BUFFER *err)

static const char *get_offset(struct tm *tm, const char *s, int sign)

static const char *get_date(const char *s, struct tm *t, BUFFER *err)

static const char *parse_date_range(const char *pc, struct tm *min, struct tm *max,
                                    int haveMin, struct tm *baseMin, BUFFER *err)

static void adjust_date_range(struct tm *min, struct tm *max)

static bool eat_date(pattern_t *pat, BUFFER *s, BUFFER *err)

static bool eat_range(pattern_t *pat, BUFFER *s, BUFFER *err)

static int report_regerror(int regerr, regex_t *preg, BUFFER *err)

static bool is_context_available(BUFFER *s, regmatch_t pmatch[], int kind, BUFFER *err)

static int scan_range_num(BUFFER *s, regmatch_t pmatch[], int group, int kind)

static int scan_range_slot(BUFFER *s, regmatch_t pmatch[], int grp, int side, int kind)

static void order_range(pattern_t *pat)

static int eat_range_by_regexp(pattern_t *pat, BUFFER *s, int kind, BUFFER *err)

static bool eat_message_range(pattern_t *pat, BUFFER *s, BUFFER *err)

int mutt_which_case(const char *s)

static int patmatch(const pattern_t *pat, const char *buf)

static int msg_search(CONTEXT *ctx, pattern_t *pat, int msgno)

static const struct pattern_flags *lookup_tag(char tag)

static /* const */ char *find_matching_paren(/* const */ char *s)

void mutt_pattern_free(pattern_t **pat)

pattern_t *mutt_pattern_comp(/* const */ char *s, int flags, BUFFER *err)

static bool perform_and(pattern_t *pat, pattern_exec_flag flags, CONTEXT *ctx,
                        HEADER *hdr, pattern_cache_t *cache)

static int perform_or(struct pattern_t *pat, pattern_exec_flag flags,
                      CONTEXT *ctx, HEADER *hdr, pattern_cache_t *cache)

static int match_adrlist(pattern_t *pat, int match_personal, int n, ...)

static bool match_reference(pattern_t *pat, LIST *refs)

int mutt_is_list_recipient(int alladdr, ADDRESS *a1, ADDRESS *a2)

int mutt_is_list_cc(int alladdr, ADDRESS *a1, ADDRESS *a2)

static int match_user(int alladdr, ADDRESS *a1, ADDRESS *a2)

static int match_threadcomplete(struct pattern_t *pat, pattern_exec_flag flags,
                                CONTEXT *ctx, THREAD *t, int left, int up,
                                int right, int down)

static void set_pattern_cache_value(int *cache_entry, int value)

static int get_pattern_cache_value(int cache_entry)

static int is_pattern_cache_set(int cache_entry)

int mutt_pattern_exec(struct pattern_t *pat, pattern_exec_flag flags,
                      CONTEXT *ctx, HEADER *h, pattern_cache_t *cache)

static void quote_simple(char *tmp, size_t len, const char *p)

void mutt_check_simple(char *s, size_t len, const char *simple)

static THREAD *top_of_thread(HEADER *h)

bool mutt_limit_current_thread(HEADER *h)

int mutt_pattern_func(int op, char *prompt)

int mutt_search_command(int cur, int op)

void pgp_void_passphrase(void)

int pgp_valid_passphrase(void)

bool pgp_use_gpg_agent(void)

static pgp_key_t _pgp_parent(pgp_key_t k)

char *pgp_long_keyid(pgp_key_t k)

char *pgp_short_keyid(pgp_key_t k)

char *pgp_keyid(pgp_key_t k)

char *_pgp_keyid(pgp_key_t k)

static char *pgp_fingerprint(pgp_key_t k)

char *pgp_fpr_or_lkeyid(pgp_key_t k)

static int pgp_copy_checksig(FILE *fpin, FILE *fpout)

static int pgp_check_decryption_okay(FILE *fpin)

static void pgp_copy_clearsigned(FILE *fpin, STATE *s, char *charset)

int pgp_application_pgp_handler(BODY *m, STATE *s)

static int pgp_check_traditional_one_body(FILE *fp, BODY *b, int tagged_only)

int pgp_check_traditional(FILE *fp, BODY *b, int tagged_only)

int pgp_verify_one(BODY *sigbdy, STATE *s, const char *tempfile)

static void pgp_extract_keys_from_attachment(FILE *fp, BODY *top)

void pgp_extract_keys_from_attachment_list(FILE *fp, int tag, BODY *top)

static BODY *pgp_decrypt_part(BODY *a, STATE *s, FILE *fpout, BODY *p)

int pgp_decrypt_mime(FILE *fpin, FILE **fpout, BODY *b, BODY **cur)

int pgp_encrypted_handler(BODY *a, STATE *s)

char *pgp_find_keys(ADDRESS *adrlist, int oppenc_mode)

int pgp_send_menu(HEADER *msg)

static void print_usage(const char *progname)

int main(int argc, char **argv)

static const char *_mutt_fmt_pgp_command(char *dest, size_t destlen, size_t col,
                                         int cols, char op, const char *src,
                                         const char *prefix, const char *ifstring,
                                         const char *elsestring,
                                         unsigned long data, format_flag flags)

static void mutt_pgp_command(char *d, size_t dlen,
                             struct pgp_command_context *cctx, const char *fmt)

static pid_t pgp_invoke(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd,
                        int pgpoutfd, int pgperrfd, short need_passphrase,
                        const char *fname, const char *sig_fname,
                        const char *signas, const char *ids, const char *format)

pid_t pgp_invoke_decode(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd,
                        int pgpoutfd, int pgperrfd, const char *fname, short need_passphrase)

pid_t pgp_invoke_verify(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd,
                        int pgpoutfd, int pgperrfd, const char *fname, const char *sig_fname)

pid_t pgp_invoke_decrypt(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd,
                         int pgpoutfd, int pgperrfd, const char *fname)

pid_t pgp_invoke_sign(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd,
                      int pgpoutfd, int pgperrfd, const char *fname)

pid_t pgp_invoke_encrypt(FILE **pgpin, FILE **pgpout, FILE **pgperr,
                         int pgpinfd, int pgpoutfd, int pgperrfd,
                         const char *fname, const char *uids, int sign)

pid_t pgp_invoke_traditional(FILE **pgpin, FILE **pgpout, FILE **pgperr,
                             int pgpinfd, int pgpoutfd, int pgperrfd,
                             const char *fname, const char *uids, int flags)

void pgp_invoke_import(const char *fname)

void pgp_invoke_getkeys(ADDRESS *addr)

pid_t pgp_invoke_export(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd,
                        int pgpoutfd, int pgperrfd, const char *uids)

pid_t pgp_invoke_verify_key(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd,
                            int pgpoutfd, int pgperrfd, const char *uids)

pid_t pgp_invoke_list_keys(FILE **pgpin, FILE **pgpout, FILE **pgperr, int pgpinfd,
                           int pgpoutfd, int pgperrfd, pgp_ring_t keyring, LIST *hints)

static char *pgp_key_abilities(int flags)

static char pgp_flags(int flags)

static pgp_key_t pgp_principal_key(pgp_key_t key)

static const char *pgp_entry_fmt(char *dest, size_t destlen, size_t col, int cols,
                                 char op, const char *src, const char *prefix,
                                 const char *ifstring, const char *elsestring,
                                 unsigned long data, format_flag flags)

static void pgp_entry(char *s, size_t l, MUTTMENU *menu, int num)

static int _pgp_compare_address(const void *a, const void *b)

static int pgp_compare_address(const void *a, const void *b)

static int _pgp_compare_keyid(const void *a, const void *b)

static int pgp_compare_keyid(const void *a, const void *b)

static int _pgp_compare_date(const void *a, const void *b)

static int pgp_compare_date(const void *a, const void *b)

static int _pgp_compare_trust(const void *a, const void *b)

static int pgp_compare_trust(const void *a, const void *b)

static bool pgp_key_is_valid(pgp_key_t k)

static bool pgp_id_is_strong(pgp_uid_t *uid)

static bool pgp_id_is_valid(pgp_uid_t *uid)

static int pgp_id_matches_addr(ADDRESS *addr, ADDRESS *u_addr, pgp_uid_t *uid)

static pgp_key_t pgp_select_key(pgp_key_t keys, ADDRESS *p, const char *s)

pgp_key_t pgp_ask_for_key(char *tag, char *whatfor, short abilities, pgp_ring_t keyring)

static LIST *pgp_add_string_to_hints(LIST *hints, const char *str)

static pgp_key_t *pgp_get_lastp(pgp_key_t p)

pgp_key_t pgp_getkeybyaddr(ADDRESS *a, short abilities, pgp_ring_t keyring, int oppenc_mode)

pgp_key_t pgp_getkeybystr(char *p, short abilities, pgp_ring_t keyring)

const char *pgp_pkalgbytype(unsigned char type)

bool pgp_canencrypt(unsigned char type)

bool pgp_cansign(unsigned char type)

short pgp_get_abilities(unsigned char type)

static void pgp_free_sig(pgp_sig_t **sigp)

static void pgp_free_uid(pgp_uid_t **upp)

pgp_uid_t *pgp_copy_uids(pgp_uid_t *up, pgp_key_t parent)

static void _pgp_free_key(pgp_key_t *kpp)

pgp_key_t pgp_remove_key(pgp_key_t *klist, pgp_key_t key)

void pgp_free_key(pgp_key_t *kpp)

static const char *pgp_hash_to_micalg(short id)

static void pgp_dearmor(FILE *in, FILE *out)

static short pgp_mic_from_packet(unsigned char *p, size_t len)

static short pgp_find_hash(const char *fname)

const char *pgp_micalg(const char *fname)

static int read_material(size_t material, size_t *used, FILE *fp)

unsigned char *pgp_read_packet(FILE *fp, size_t *len)

void pgp_release_packet(void)

static char gnupg_trustletter(int t)

static void print_userid(const char *id)

static void print_fingerprint(pgp_key_t p)

static void pgpring_dump_signatures(pgp_sig_t *sig)

static void pgpring_dump_keyblock(pgp_key_t p)

static bool pgpring_string_matches_hint(const char *s, const char *hints[], int nhints)

static void pgp_make_pgp2_fingerprint(unsigned char *buff, unsigned char *digest)

static char *binary_fingerprint_to_string(unsigned char *buff, size_t length)

static pgp_key_t pgp_parse_pgp2_key(unsigned char *buff, size_t l)

static void pgp_make_pgp3_fingerprint(unsigned char *buff, size_t l, unsigned char *digest)

static void skip_bignum(unsigned char *buff, size_t l, size_t j, size_t *toff, size_t n)

static pgp_key_t pgp_parse_pgp3_key(unsigned char *buff, size_t l)

static pgp_key_t pgp_parse_keyinfo(unsigned char *buff, size_t l)

static int pgp_parse_pgp2_sig(unsigned char *buff, size_t l, pgp_key_t p, pgp_sig_t *s)

static int pgp_parse_pgp3_sig(unsigned char *buff, size_t l, pgp_key_t p, pgp_sig_t *s)

static int pgp_parse_sig(unsigned char *buff, size_t l, pgp_key_t p, pgp_sig_t *sig)

static pgp_key_t pgp_parse_keyblock(FILE *fp)

static void pgpring_find_candidates(char *ringfile, const char *hints[], int nhints)

int main(int argc, char *const argv[])

static pop_auth_res_t pop_auth_sasl(POP_DATA *pop_data, const char *method)

void pop_apop_timestamp(POP_DATA *pop_data, char *buf)

static pop_auth_res_t pop_auth_apop(POP_DATA *pop_data, const char *method)

static pop_auth_res_t pop_auth_user(POP_DATA *pop_data, const char *method)

int pop_authenticate(POP_DATA *pop_data)

static int fetch_message(char *line, void *file)

static int pop_read_header(POP_DATA *pop_data, HEADER *h)

static int fetch_uidl(char *line, void *data)

static int msg_cache_check(const char *id, body_cache_t *bcache, void *data)

static int pop_hcache_namer(const char *path, char *dest, size_t destlen)

static header_cache_t *pop_hcache_open(POP_DATA *pop_data, const char *path)

static int pop_fetch_headers(CONTEXT *ctx)

static int pop_open_mailbox(CONTEXT *ctx)

static void pop_clear_cache(POP_DATA *pop_data)

static int pop_close_mailbox(CONTEXT *ctx)

static int pop_fetch_message(CONTEXT *ctx, MESSAGE *msg, int msgno)

static int pop_close_message(CONTEXT *ctx, MESSAGE *msg)

static int pop_sync_mailbox(CONTEXT *ctx, int *index_hint)

static int pop_check_mailbox(CONTEXT *ctx, int *index_hint)

void pop_fetch_mail(void)

int pop_parse_path(const char *path, ACCOUNT *acct)

static void pop_error(POP_DATA *pop_data, char *msg)

static int fetch_capa(char *line, void *data)

static int fetch_auth(char *line, void *data)

static int pop_capabilities(POP_DATA *pop_data, int mode)

int pop_connect(POP_DATA *pop_data)

int pop_open_connection(POP_DATA *pop_data)

void pop_logout(CONTEXT *ctx)

int pop_query_d(POP_DATA *pop_data, char *buf, size_t buflen, char *msg)

int pop_fetch_data(POP_DATA *pop_data, char *query, progress_t *progressbar,
                   int (*funct)(char *, void *), void *data)

static int check_uidl(char *line, void *data)

int pop_reconnect(CONTEXT *ctx)

int mutt_num_postponed(int force)

void mutt_update_num_postponed(void)

static void post_entry(char *s, size_t slen, MUTTMENU *menu, int entry)

static HEADER *select_msg(void)

int mutt_get_postponed(CONTEXT *ctx, HEADER *hdr, HEADER **cur, char *fcc, size_t fcclen)

int mutt_parse_crypt_hdr(const char *p, int set_empty_signas, int crypt_app)

int mutt_prepare_template(FILE *fp, CONTEXT *ctx, HEADER *newhdr, HEADER *hdr, short resend)

static ADDRESS *result_to_addr(QUERY *r)

static void free_query(QUERY **query)

static QUERY *run_query(char *s, int quiet)

static int query_search(MUTTMENU *m, regex_t *re, int n)

static const char *query_format_str(char *dest, size_t destlen, size_t col, int cols,
                                    char op, const char *src, const char *fmt,
                                    const char *ifstring, const char *elsestring,
                                    unsigned long data, format_flag flags)

static void query_entry(char *s, size_t slen, MUTTMENU *m, int num)

static int query_tag(MUTTMENU *menu, int n, int m)

static void query_menu(char *buf, size_t buflen, QUERY *results, int retbuf)

int mutt_query_complete(char *buf, size_t buflen)

void mutt_query_menu(char *buf, size_t buflen)

void mutt_update_tree(ATTACHPTR **idx, short idxlen)

const char *mutt_attach_fmt(char *dest, size_t destlen, size_t col, int cols,
                            char op, const char *src, const char *prefix,
                            const char *ifstring, const char *elsestring,
                            unsigned long data, format_flag flags)

static void attach_entry(char *b, size_t blen, MUTTMENU *menu, int num)

int mutt_tag_attach(MUTTMENU *menu, int n, int m)

bool mutt_is_message_type(int type, const char *subtype)

static void prepend_curdir(char *dst, size_t dstlen)

static int query_save_attachment(FILE *fp, BODY *body, HEADER *hdr, char **directory)

void mutt_save_attachment_list(FILE *fp, int tag, BODY *top, HEADER *hdr, MUTTMENU *menu)

static void query_pipe_attachment(char *command, FILE *fp, BODY *body, int filter)

static void pipe_attachment(FILE *fp, BODY *b, STATE *state)

static void pipe_attachment_list(char *command, FILE *fp, int tag, BODY *top,
                                 int filter, STATE *state)

void mutt_pipe_attachment_list(FILE *fp, int tag, BODY *top, int filter)

static int can_print(BODY *top, int tag)

static void print_attachment_list(FILE *fp, int tag, BODY *top, STATE *state)

void mutt_print_attachment_list(FILE *fp, int tag, BODY *top)

static void update_attach_index(BODY *cur, ATTACHPTR ***idxp, short *idxlen,
                                short *idxmax, MUTTMENU *menu)

int mutt_attach_display_loop(MUTTMENU *menu, int op, FILE *fp, HEADER *hdr, BODY *cur,
                             ATTACHPTR ***idxp, short *idxlen, short *idxmax, int recv)

static void attach_collapse(BODY *b, short collapse, short init, short just_one)

void mutt_attach_init(BODY *b)

void mutt_view_attachments(HEADER *hdr)

static bool check_msg(BODY *b, bool err)

static bool check_all_msg(ATTACHPTR **idx, short idxlen, BODY *cur, bool err)

static short check_can_decode(ATTACHPTR **idx, short idxlen, BODY *cur)

static short count_tagged(ATTACHPTR **idx, short idxlen)

static short count_tagged_children(ATTACHPTR **idx, short idxlen, short i)

void mutt_attach_bounce(FILE *fp, HEADER *hdr, ATTACHPTR **idx, short idxlen, BODY *cur)

void mutt_attach_resend(FILE *fp, HEADER *hdr, ATTACHPTR **idx, short idxlen, BODY *cur)

static HEADER *find_common_parent(ATTACHPTR **idx, short idxlen, short nattach)

static bool is_parent(short i, ATTACHPTR **idx, short idxlen, BODY *cur)

static HEADER *find_parent(ATTACHPTR **idx, short idxlen, BODY *cur, short nattach)

static void include_header(int quote, FILE *ifp, HEADER *hdr, FILE *ofp, char *_prefix)

static BODY **copy_problematic_attachments(FILE *fp, BODY **last, ATTACHPTR **idx,
                                           short idxlen, short force)

static void attach_forward_bodies(FILE *fp, HEADER *hdr, ATTACHPTR **idx,
                                  short idxlen, BODY *cur, short nattach, int flags)

static void attach_forward_msgs(FILE *fp, HEADER *hdr, ATTACHPTR **idx,
                                short idxlen, BODY *cur, int flags)

void mutt_attach_forward(FILE *fp, HEADER *hdr, ATTACHPTR **idx, short idxlen,
                         BODY *cur, int flags)

static int attach_reply_envelope_defaults(ENVELOPE *env, ATTACHPTR **idx,
                                          short idxlen, HEADER *parent, int flags)

static void attach_include_reply(FILE *fp, FILE *tmpfp, HEADER *cur, int flags)

void mutt_attach_reply(FILE *fp, HEADER *hdr, ATTACHPTR **idx, short idxlen,
                       BODY *cur, int flags)

static int mix_get_caps(const char *capstr)

static void mix_add_entry(REMAILER ***type2_list, REMAILER *entry, size_t *slots, size_t *used)

static REMAILER *mix_new_remailer(void)

static void mix_free_remailer(REMAILER **r)

static REMAILER **mix_type2_list(size_t *l)

static void mix_free_type2_list(REMAILER ***ttlp)

static void mix_screen_coordinates(REMAILER **type2_list, struct coord **coordsp,
                                   MIXCHAIN *chain, int i)

static void mix_redraw_ce(REMAILER **type2_list, struct coord *coords,
                          MIXCHAIN *chain, int i, short selected)

static void mix_redraw_chain(REMAILER **type2_list, struct coord *coords,
                             MIXCHAIN *chain, int cur)

static void mix_redraw_head(MIXCHAIN *chain)

static const char *mix_format_caps(REMAILER *r)

static const char *mix_entry_fmt(char *dest, size_t destlen, size_t col, int cols,
                                 char op, const char *src, const char *prefix,
                                 const char *ifstring, const char *elsestring,
                                 unsigned long data, format_flag flags)

static void mix_entry(char *b, size_t blen, MUTTMENU *menu, int num)

static int mix_chain_add(MIXCHAIN *chain, const char *s, REMAILER **type2_list)

void mix_make_chain(LIST **chainp)

int mix_check_message(HEADER *msg)

int mix_send_message(LIST *chain, const char *tempfile)

void mutt_resize_screen(void)

int rfc1524_expand_command(BODY *a, char *filename, char *_type, char *command, int clen)

static char *get_field(char *s)

static int get_field_text(char *field, char **entry, char *type, char *filename, int line)

static int rfc1524_mailcap_parse(BODY *a, char *filename, char *type,
                                 rfc1524_entry *entry, int opt)

rfc1524_entry *rfc1524_new_entry(void)

void rfc1524_free_entry(rfc1524_entry **entry)

int rfc1524_mailcap_lookup(BODY *a, char *type, rfc1524_entry *entry, int opt)

static void strnfcpy(char *d, char *s, size_t siz, size_t len)

int rfc1524_expand_filename(char *nametemplate, char *oldfile, char *newfile, size_t nflen)

int mutt_rename_file(char *oldfile, char *newfile)

static size_t convert_string(ICONV_CONST char *f, size_t flen, const char *from,
                             const char *to, char **t, size_t *tlen)

int convert_nonmime_string(char **ps)

char *mutt_choose_charset(const char *fromcode, const char *charsets, char *u,
                          size_t ulen, char **d, size_t *dlen)

static size_t b_encoder(char *s, ICONV_CONST char *d, size_t dlen, const char *tocode)

static size_t q_encoder(char *s, ICONV_CONST char *d, size_t dlen, const char *tocode)

static size_t try_block(ICONV_CONST char *d, size_t dlen, const char *fromcode,
                        const char *tocode, encoder_t *encoder, size_t *wlen)

static size_t encode_block(char *s, char *d, size_t dlen, const char *fromcode,
                           const char *tocode, encoder_t encoder)

static size_t choose_block(char *d, size_t dlen, int col, const char *fromcode,
                           const char *tocode, encoder_t *encoder, size_t *wlen)

static int rfc2047_encode(ICONV_CONST char *d, size_t dlen, int col, const char *fromcode,
                          const char *charsets, char **e, size_t *elen, char *specials)

void _rfc2047_encode_string(char **pd, int encode_specials, int col)

void rfc2047_encode_adrlist(ADDRESS *addr, const char *tag)

static int rfc2047_decode_word(char *d, const char *s, size_t len)

static const char *find_encoded_word(const char *s, const char **x)

static size_t lwslen(const char *s, size_t n)

static size_t lwsrlen(const char *s, size_t n)

void rfc2047_decode(char **pd)

void rfc2047_decode_adrlist(ADDRESS *a)

static void purge_empty_parameters(PARAMETER **headp)

static char *rfc2231_get_charset(char *value, char *charset, size_t chslen)

static void rfc2231_decode_one(char *dest, char *src)

static struct rfc2231_parameter *rfc2231_new_parameter(void)

static void rfc2231_list_insert(struct rfc2231_parameter **list, struct rfc2231_parameter *par)

static void rfc2231_free_parameter(struct rfc2231_parameter **p)

static void rfc2231_join_continuations(PARAMETER **head, struct rfc2231_parameter *par)

void rfc2231_decode_parameters(PARAMETER **headp)

int rfc2231_encode_string(char **pd)

static int get_quote_level(const char *line)

static int space_quotes(STATE *s)

static bool add_quote_suffix(STATE *s, int ql)

static size_t print_indent(int ql, STATE *s, int add_suffix)

static void flush_par(STATE *s, flowed_state_t *fst)

static int quote_width(STATE *s, int ql)

static void print_flowed_line(char *line, STATE *s, int ql, flowed_state_t *fst, int term)

static void print_fixed_line(const char *line, STATE *s, int ql, flowed_state_t *fst)

int rfc3676_handler(BODY *a, STATE *s)

void rfc3676_space_stuff(HEADER *hdr)

void rfc822_dequote_comment(char *s)

static void free_address(ADDRESS *a)

int rfc822_remove_from_adrlist(ADDRESS **a, const char *mailbox)

void rfc822_free_address(ADDRESS **p)

static const char *parse_comment(const char *s, char *comment, size_t *commentlen, size_t commentmax)

static const char *parse_quote(const char *s, char *token, size_t *tokenlen, size_t tokenmax)

static const char *next_token(const char *s, char *token, size_t *tokenlen, size_t tokenmax)

static const char *parse_mailboxdomain(const char *s, const char *nonspecial,
                                       char *mailbox, size_t *mailboxlen,
                                       size_t mailboxmax, char *comment,
                                       size_t *commentlen, size_t commentmax)

static const char *parse_address(const char *s, char *token, size_t *tokenlen,
                                 size_t tokenmax, char *comment, size_t *commentlen,
                                 size_t commentmax, ADDRESS *addr)

static const char *parse_route_addr(const char *s, char *comment, size_t *commentlen,
                                    size_t commentmax, ADDRESS *addr)

static const char *parse_addr_spec(const char *s, char *comment, size_t *commentlen,
                                   size_t commentmax, ADDRESS *addr)

static void add_addrspec(ADDRESS **top, ADDRESS **last, const char *phrase,
                         char *comment, size_t *commentlen, size_t commentmax)

void rfc822_qualify(ADDRESS *addr, const char *host)

void rfc822_cat(char *buf, size_t buflen, const char *value, const char *specials)

void rfc822_write_address_single(char *buf, size_t buflen, ADDRESS *addr, int display)

int rfc822_write_address(char *buf, size_t buflen, ADDRESS *addr, int display)

bool rfc822_valid_msgid(const char *msgid)

int safe_free(void **p) /* __SAFE_FREE_CHECKED__ */

int main(int argc, char **argv)

int safe_asprintf(char **strp, const char *fmt, ...)

int safe_asprintf(char **strp, const char *fmt, ...)

void mutt_check_rescore(CONTEXT *ctx)

int mutt_parse_score(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

void mutt_score_message(CONTEXT *ctx, HEADER *hdr, int upd_ctx)

int mutt_parse_unscore(BUFFER *buf, BUFFER *s, unsigned long data, BUFFER *err)

static void append_signature(FILE *f)

static bool addrcmp(ADDRESS *a, ADDRESS *b)

static int addrsrc(ADDRESS *a, ADDRESS *lst)

static ADDRESS *remove_user(ADDRESS *a, int leave_only)

static ADDRESS *find_mailing_lists(ADDRESS *t, ADDRESS *c)

static int edit_address(ADDRESS **a, /* const */ char *field)

static int edit_envelope(ENVELOPE *en, int flags)

static char *nntp_get_header(const char *s)

static void process_user_recips(ENVELOPE *env)

static void process_user_header(ENVELOPE *env)

void mutt_forward_intro(FILE *fp, HEADER *cur)

void mutt_forward_trailer(FILE *fp)

static int include_forward(CONTEXT *ctx, HEADER *cur, FILE *out)

void mutt_make_attribution(CONTEXT *ctx, HEADER *cur, FILE *out)

void mutt_make_post_indent(CONTEXT *ctx, HEADER *cur, FILE *out)

static int include_reply(CONTEXT *ctx, HEADER *cur, FILE *out)

static int default_to(ADDRESS **to, ENVELOPE *env, int flags, int hmfupto)

int mutt_fetch_recips(ENVELOPE *out, ENVELOPE *in, int flags)

static LIST *make_references(ENVELOPE *e)

void mutt_fix_reply_recipients(ENVELOPE *env)

void mutt_make_forward_subject(ENVELOPE *env, CONTEXT *ctx, HEADER *cur)

void mutt_make_misc_reply_headers(ENVELOPE *env, CONTEXT *ctx, HEADER *cur, ENVELOPE *curenv)

void mutt_add_to_reference_headers(ENVELOPE *env, ENVELOPE *curenv, LIST ***pp, LIST ***qq)

static void make_reference_headers(ENVELOPE *curenv, ENVELOPE *env, CONTEXT *ctx)

static int envelope_defaults(ENVELOPE *env, CONTEXT *ctx, HEADER *cur, int flags)

static int generate_body(FILE *tempfp, /* stream for outgoing message */
                         HEADER *msg,  /* header for outgoing message */
                         int flags,    /* compose mode */
                         CONTEXT *ctx, /* current mailbox */
                         HEADER *cur)  /* current message */

void mutt_set_followup_to(ENVELOPE *e)

static ADDRESS *set_reverse_name(ENVELOPE *env)

static int send_message(HEADER *msg)

void mutt_encode_descriptions(BODY *b, short recurse)

static void decode_descriptions(BODY *b)

static void fix_end_of_file(const char *data)

int mutt_compose_to_sender(HEADER *hdr)

int mutt_resend_message(FILE *fp, CONTEXT *ctx, HEADER *cur)

static int is_reply(HEADER *reply, HEADER *orig)

static int has_recips(ADDRESS *a)

static int mutt_search_attach_keyword(char *filename)

int ci_send_message(int flags,      /* send mode */
                    HEADER *msg,    /* template to use for new message */
                    char *tempfile, /* file specified by -i or -H */
                    CONTEXT *ctx,   /* current mailbox */
                    HEADER *cur)    /* current message */

static void encode_quoted(FGETCONV *fc, FILE *fout, int istext)

static int b64_init(struct b64_context *ctx)

static void b64_flush(struct b64_context *ctx, FILE *fout)

static void b64_putc(struct b64_context *ctx, char c, FILE *fout)

static void encode_base64(FGETCONV *fc, FILE *fout, int istext)

static void encode_8bit(FGETCONV *fc, FILE *fout, int istext)

int mutt_write_mime_header(BODY *a, FILE *f)

int mutt_write_mime_body(BODY *a, FILE *f)

void mutt_generate_boundary(PARAMETER **parm)

static void update_content_info(CONTENT *info, CONTENT_STATE *s, char *d, size_t dlen)

static size_t convert_file_to(FILE *file, const char *fromcode, int ncodes,
                              const char **tocodes, int *tocode, CONTENT *info)

static size_t convert_file_from_to(FILE *file, const char *fromcodes, const char *tocodes,
                                   char **fromcode, char **tocode, CONTENT *info)

int mutt_lookup_mime_type(BODY *att, const char *path)

static void transform_to_7bit(BODY *a, FILE *fpin)

void mutt_message_to_7bit(BODY *a, FILE *fp)

static void set_encoding(BODY *b, CONTENT *info)

void mutt_stamp_attachment(BODY *a)

char *mutt_get_body_charset(char *d, size_t dlen, BODY *b)

void mutt_update_encoding(BODY *a)

static int get_toplevel_encoding(BODY *a)

static bool check_boundary(const char *boundary, BODY *b)

char *mutt_make_date(char *s, size_t len)

void mutt_write_address_list(ADDRESS *adr, FILE *fp, int linelen, int display)

void mutt_write_references(LIST *r, FILE *f, int trim)

static const char *find_word(const char *src)

static int my_width(const char *str, int col, int flags)

static int print_val(FILE *fp, const char *pfx, const char *value, int flags, size_t col)

static int fold_one_header(FILE *fp, const char *tag, const char *value,
                           const char *pfx, int wraplen, int flags)

static char *unfold_header(char *s)

static int write_one_header(FILE *fp, int pfxw, int max, int wraplen, const char *pfx,
                            const char *start, const char *end, int flags)

int mutt_write_one_header(FILE *fp, const char *tag, const char *value,
                          const char *pfx, int wraplen, int flags)

int mutt_write_rfc822_header(FILE *fp, ENVELOPE *env, BODY *attach, int mode, int privacy)

static void encode_headers(LIST *h)

const char *mutt_fqdn(short may_hide_host)

static char *gen_msgid(void)

static void alarm_handler(int sig)

static int send_msg(const char *path, char **args, const char *msg, char **tempfile)

static char **add_args(char **args, size_t *argslen, size_t *argsmax, ADDRESS *addr)

static char **add_option(char **args, size_t *argslen, size_t *argsmax, char *s)

int mutt_invoke_sendmail(ADDRESS *from, /* the sender */
                         ADDRESS *to, ADDRESS *cc, ADDRESS *bcc, /* recips */
                         const char *msg, /* file containing message */
                         int eightbit)    /* message contains 8bit chars */

void mutt_prepare_envelope(ENVELOPE *env, int final)

void mutt_unprepare_envelope(ENVELOPE *env)

static int _mutt_bounce_message(FILE *fp, HEADER *h, ADDRESS *to,
                                const char *resent_from, ADDRESS *env_from)

int mutt_bounce_message(FILE *fp, HEADER *h, ADDRESS *to)

static void set_noconv_flags(BODY *b, short flag)

int mutt_write_multiple_fcc(const char *path, HEADER *hdr, const char *msgid,
                            int post, char *fcc, char **finalpath)

int mutt_write_fcc(const char *path, HEADER *hdr, const char *msgid, int post,
                   char *fcc, char **finalpath)

void sha1_transform(uint32_t state[5], const unsigned char buffer[64])

void sha1_init(SHA1_CTX *context)

void sha1_update(SHA1_CTX *context, const unsigned char *data, uint32_t len)

void sha1_final(unsigned char digest[20], SHA1_CTX *context)

static BUFFY *get_incoming(void)

static const char *cb_format_str(char *dest, size_t destlen, size_t col, int cols,
                                 char op, const char *src, const char *prefix,
                                 const char *ifstring, const char *elsestring,
                                 unsigned long data, format_flag flags)

static void make_sidebar_entry(char *buf, unsigned int buflen, int width,
                               char *box, SBENTRY *sbe)

static int cb_qsort_sbe(const void *a, const void *b)

static void update_entries_visibility(void)

static void unsort_entries(void)

static void sort_entries(void)

static bool select_next(void)

static int select_next_new(void)

static bool select_prev(void)

static bool select_prev_new(void)

static int select_page_down(void)

static int select_page_up(void)

static bool prepare_sidebar(int page_size)

static int draw_divider(int num_rows, int num_cols)

static void fill_empty_space(int first_row, int num_rows, int div_width, int num_cols)

static void draw_sidebar(int num_rows, int num_cols, int div_width)

void mutt_sb_draw(void)

void mutt_sb_change_mailbox(int op)

void mutt_sb_set_buffystats(const CONTEXT *ctx)

const char *mutt_sb_get_highlight(void)

void mutt_sb_set_open_buffy(void)

void mutt_sb_notify_mailbox(BUFFY *b, int created)

void mutt_sb_toggle_virtual(void)

static void exit_handler(int sig)

static void chld_handler(int sig)

static void sighandler(int sig)

static int mutt_intr_hook(void)

void mutt_signal_init(void)

void mutt_block_signals(void)

void mutt_unblock_signals(void)

void mutt_block_signals_system(void)

void mutt_unblock_signals_system(int catch)

void mutt_allow_interrupt(int disposition)

static void smime_free_key(smime_key_t **keylist)

static smime_key_t *smime_copy_key(smime_key_t *key)

void smime_void_passphrase(void)

int smime_valid_passphrase(void)

static const char *_mutt_fmt_smime_command(char *dest, size_t destlen, size_t col,
                                           int cols, char op, const char *src,
                                           const char *prefix, const char *ifstring,
                                           const char *elsestring,
                                           unsigned long data, format_flag flags)

static void smime_command(char *d, size_t dlen,
                          struct smime_command_context *cctx, const char *fmt)

static pid_t smime_invoke(FILE **smimein, FILE **smimeout, FILE **smimeerr,
                          int smimeinfd, int smimeoutfd, int smimeerrfd,
                          const char *fname, const char *sig_fname, const char *cryptalg,
                          const char *digestalg, const char *key, const char *certificates,
                          const char *intermediates, const char *format)

static char *smime_key_flags(int flags)

static void smime_entry(char *s, size_t l, MUTTMENU *menu, int num)

static smime_key_t *smime_select_key(smime_key_t *keys, char *query)

static smime_key_t *smime_parse_key(char *buf)

static smime_key_t *smime_get_candidates(char *search, short public)

static smime_key_t *smime_get_key_by_hash(char *hash, short public)

static smime_key_t *smime_get_key_by_addr(char *mailbox, short abilities,
                                          short public, short may_ask)

static smime_key_t *smime_get_key_by_str(char *str, short abilities, short public)

static smime_key_t *smime_ask_for_key(char *prompt, short abilities, short public)

static void _smime_getkeys(char *mailbox)

void smime_getkeys(ENVELOPE *env)

char *smime_find_keys(ADDRESS *adrlist, int oppenc_mode)

static int smime_handle_cert_email(char *certificate, char *mailbox, int copy,
                                   char ***buffer, int *num)

static char *smime_extract_certificate(char *infile)

static char *smime_extract_signer_certificate(char *infile)

void smime_invoke_import(char *infile, char *mailbox)

int smime_verify_sender(HEADER *h)

static pid_t smime_invoke_encrypt(FILE **smimein, FILE **smimeout, FILE **smimeerr,
                                  int smimeinfd, int smimeoutfd, int smimeerrfd,
                                  const char *fname, const char *uids)

static pid_t smime_invoke_sign(FILE **smimein, FILE **smimeout, FILE **smimeerr, int smimeinfd,
                               int smimeoutfd, int smimeerrfd, const char *fname)

static char *openssl_md_to_smime_micalg(char *md)

static pid_t smime_invoke_verify(FILE **smimein, FILE **smimeout, FILE **smimeerr,
                                 int smimeinfd, int smimeoutfd, int smimeerrfd,
                                 const char *fname, const char *sig_fname, int opaque)

static pid_t smime_invoke_decrypt(FILE **smimein, FILE **smimeout,
                                  FILE **smimeerr, int smimeinfd, int smimeoutfd,
                                  int smimeerrfd, const char *fname)

int smime_verify_one(BODY *sigbdy, STATE *s, const char *tempfile)

static BODY *smime_handle_entity(BODY *m, STATE *s, FILE *outFile)

int smime_decrypt_mime(FILE *fpin, FILE **fpout, BODY *b, BODY **cur)

int smime_application_smime_handler(BODY *m, STATE *s)

int smime_send_menu(HEADER *msg)

static bool valid_smtp_code(char *buf, size_t len, int *n)

static int smtp_get_resp(CONNECTION *conn)

static int smtp_rcpt_to(CONNECTION *conn, const ADDRESS *a)

static int smtp_data(CONNECTION *conn, const char *msgfile)

static bool address_uses_unicode(const char *a)

static bool addresses_use_unicode(const ADDRESS *a)

static int smtp_fill_account(ACCOUNT *account)

static int smtp_helo(CONNECTION *conn)

static int smtp_auth_sasl(CONNECTION *conn, const char *mechlist)

static int smtp_auth(CONNECTION *conn)

static int smtp_auth_plain(CONNECTION *conn)

static int smtp_open(CONNECTION *conn)

int mutt_smtp_send(const ADDRESS *from, const ADDRESS *to, const ADDRESS *cc,
                   const ADDRESS *bcc, const char *msgfile, int eightbit)

static int compare_score(const void *a, const void *b)

static int compare_size(const void *a, const void *b)

static int compare_date_sent(const void *a, const void *b)

static int compare_subject(const void *a, const void *b)

const char *mutt_get_name(ADDRESS *a)

static int compare_to(const void *a, const void *b)

static int compare_from(const void *a, const void *b)

static int compare_date_received(const void *a, const void *b)

static int compare_order(const void *a, const void *b)

static int compare_spam(const void *a, const void *b)

static int compare_label(const void *a, const void *b)

sort_t *mutt_get_sort_func(int method)

void mutt_sort_headers(CONTEXT *ctx, int init)

static char *get_sort_str(char *buf, size_t buflen, int method)

static const char *status_format_str(char *buf, size_t buflen, size_t col, int cols,
                                     char op, const char *src, const char *prefix,
                                     const char *ifstring, const char *elsestring,
                                     unsigned long data, format_flag flags)

static const char *status_format_str(char *buf, size_t buflen, size_t col, int cols,
                                     char op, const char *src, const char *prefix,
                                     const char *ifstring, const char *elsestring,
                                     unsigned long data, format_flag flags)

static void _menu_status_line(char *buf, size_t buflen, size_t col, int cols,
                              MUTTMENU *menu, const char *p)

void menu_status_line(char *buf, size_t buflen, MUTTMENU *menu, const char *p)

char *strcasestr(const char *s1, const char *s2)

int _mutt_system(const char *cmd, int flags)

static int is_descendant(THREAD *a, THREAD *b)

static int need_display_subject(CONTEXT *ctx, HEADER *hdr)

static void linearize_tree(CONTEXT *ctx)

static void calculate_visibility(CONTEXT *ctx, int *max_depth)

void mutt_draw_tree(CONTEXT *ctx)

static LIST *make_subject_list(THREAD *cur, time_t *dateptr)

static THREAD *find_subject(CONTEXT *ctx, THREAD *cur)

static void unlink_message(THREAD **old, THREAD *cur)

static void insert_message(THREAD **new, THREAD *newparent, THREAD *cur)

static HASH *make_subj_hash(CONTEXT *ctx)

static void pseudo_threads(CONTEXT *ctx)

void mutt_clear_threads(CONTEXT *ctx)

static int compare_threads(const void *a, const void *b)

static void check_subjects(CONTEXT *ctx, int init)

void mutt_sort_threads(CONTEXT *ctx, int init)

static HEADER *find_virtual(THREAD *cur, int reverse)

int _mutt_aside_thread(HEADER *hdr, short dir, short subthreads)

int mutt_parent_message(CONTEXT *ctx, HEADER *hdr, int find_root)

void mutt_set_virtual(CONTEXT *ctx)

int _mutt_traverse_thread(CONTEXT *ctx, HEADER *cur, int flag)

int mutt_messages_in_thread(CONTEXT *ctx, HEADER *hdr, int flag)

static void clean_references(THREAD *brk, THREAD *cur)

void mutt_break_thread(HEADER *hdr)

static bool link_threads(HEADER *parent, HEADER *child, CONTEXT *ctx)

int mutt_link_threads(HEADER *cur, HEADER *last, CONTEXT *ctx)

void static txt2c(char *sym, FILE *fp)

int main(int argc, char *argv[])

int url_pct_decode(char *s)

url_scheme_t url_check_scheme(const char *s)

static int ciss_parse_userhost(ciss_url_t *ciss, char *src)

int url_parse_ciss(ciss_url_t *ciss, char *src)

static void url_pct_encode(char *dst, size_t l, const char *src)

int url_ciss_tostring(ciss_url_t *ciss, char *dest, size_t len, int flags)

int url_parse_mailto(ENVELOPE *e, char **body, const char *src)

int mutt_wctoutf8(char *s, unsigned int c, size_t buflen)

static void print_compile_options(void)

static char *rstrip_in_place(char *s)

void print_version(void)

void print_copyright(void)

bool feature_enabled(const char *name)

int wcscasecmp(const wchar_t *a, const wchar_t *b)

int wcwidth_ucs(wchar_t ucs)

